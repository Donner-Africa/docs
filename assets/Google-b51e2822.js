import{l,B as u,o as v,A as f,S as t,U as g,a as m,f as w,e as h,m as p,z as _}from"./index-5f7a37b4.js";import{S as x}from"./StarryBackground-f8eca98f.js";const y={class:"min-h-screen flex items-center justify-center relative overflow-hidden bg-background"},S={__name:"Google",setup(k){const c=u();return v(async()=>{var a;await new Promise(e=>setTimeout(e,300));try{const e=window.location.hash.substring(1),s=new URLSearchParams(e).get("id_token");if(!s)throw new Error("No ID token received from Google");let n=null;try{const r=await fetch("https://ipapi.co/json/");if(r.ok){const i=await r.json();n=`${i.city}, ${i.region}, ${i.country}`}}catch{}const d={provider:"google",accessToken:s,location:n},{data:o}=await f.createSession(d);if(((a=o.verification)==null?void 0:a.status)!=="VERIFIED"){await t.IndexedDB.set("DonnerDB","UserStore","verification",o.verification),c.push({name:"Verification"});return}o!=null&&o.deviceToken?(await t.IndexedDB.set("DonnerDB","UserStore","authorization",{token:o.deviceToken}),t.LocalStorage.set("DA_IS_AUTHORITY",!0),await t.IndexedDB.delete("DonnerDB","UserStore","preAuthorization"),o.user&&g.set("user",{...o.user}),window.location.href="/"):(console.error("No deviceToken in session response"),window.location.href="/account/login?error=session")}catch(e){console.error("Google sign-in failed",e),window.location.href="/account/login?error=google"}}),(a,e)=>(m(),w("div",y,[h(x),e[0]||(e[0]=p('<div class="container mx-auto px-4 relative z-10" data-v-8284e5de><div class="max-w-lg mx-auto" data-v-8284e5de><div class="bg-card shadow-xl rounded-2xl p-5 flex flex-col items-center text-center animate-slide-up" data-v-8284e5de><div class="w-24 h-24 rounded-full bg-card shadow ring-1 ring-border flex items-center justify-center mb-6" data-v-8284e5de><img src="'+_+'" class="w-16 h-16" alt="App Icon" data-v-8284e5de></div><h2 class="text-2xl font-semibold mb-2" data-v-8284e5de>Signing you in with Google</h2><p class="text-muted-foreground mb-6" data-v-8284e5de> Please wait while we authenticate you with Google. </p><div class="flex justify-center" data-v-8284e5de><div class="loader" data-v-8284e5de></div></div></div></div></div>',1))]))}},I=l(S,[["__scopeId","data-v-8284e5de"]]);export{I as default};
