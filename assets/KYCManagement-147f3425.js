import{P as q}from"./PermissionGate-ee40ae78.js";import{S as B}from"./StatusBadge-17f375bb.js";import{l as F,r as h,a as i,f as a,b as e,n as m,t as l,F as f,g as p,h as g,e as b,d as r,c as N,s as y,C as K,x as R,v as Y,w as S}from"./index-5f7a37b4.js";const A={name:"KYCManagement",components:{PermissionGate:q,StatusBadge:B},data(){return{userRole:"ADMIN",userPermissions:["kyc:view","kyc:submit"],submitting:!1,stageFormData:{},stages:[{id:"basic_info",name:"Basic Info",status:"verified",verifiedAt:new Date(Date.now()-864e5*30),description:"Provide basic organization information.",hasForm:!0,formFields:[{id:"org_name",label:"Organization Name",type:"text",required:!0,colClass:"col-md-6"},{id:"org_type",label:"Organization Type",type:"select",required:!0,colClass:"col-md-6",options:[{value:"ngo",label:"NGO"},{value:"foundation",label:"Foundation"},{value:"government",label:"Government Body"}]},{id:"registration_number",label:"Registration Number",type:"text",required:!0,colClass:"col-md-6"},{id:"contact_email",label:"Contact Email",type:"email",required:!0,colClass:"col-md-6"}],requirements:[{id:1,label:"Organization name provided",completed:!0},{id:2,label:"Registration number submitted",completed:!0},{id:3,label:"Contact information added",completed:!0}]},{id:"documents",name:"Documents",status:"verified",verifiedAt:new Date(Date.now()-864e5*20),description:"Upload required legal documents.",documentsRequired:!0,requiredDocuments:[{id:"cac",name:"CAC Certificate",description:"Certificate of Incorporation",uploaded:!0,fileName:"cac_cert.pdf"},{id:"tin",name:"Tax Identification",description:"TIN Certificate",uploaded:!0,fileName:"tin.pdf"}],requirements:[{id:1,label:"CAC Certificate uploaded",completed:!0},{id:2,label:"TIN Certificate uploaded",completed:!0}]},{id:"bank_verification",name:"Bank Verification",status:"in_progress",description:"Verify your organization's bank account.",documentsRequired:!0,requiredDocuments:[{id:"bank_statement",name:"Bank Statement",description:"Statement from the last 3 months",uploaded:!1},{id:"account_confirmation",name:"Account Confirmation Letter",description:"Letter from the bank confirming account ownership",uploaded:!1}],requirements:[{id:1,label:"Bank account details provided",completed:!0},{id:2,label:"Bank statement uploaded (last 3 months)",completed:!1,hint:"PDF format, max 5MB"},{id:3,label:"Account ownership verified",completed:!1}]},{id:"full_kyc",name:"Full KYC",status:"not_started",description:"Complete full KYC for unlimited features.",documentsRequired:!0,requiredDocuments:[{id:"director_id",name:"Director ID",description:"Government-issued ID of a director",uploaded:!1},{id:"address_proof",name:"Proof of Address",description:"Utility bill or bank statement",uploaded:!1}],requirements:[{id:1,label:"Director identification submitted",completed:!1},{id:2,label:"Address verification completed",completed:!1},{id:3,label:"Video verification call scheduled",completed:!1}]}],selectedStage:null,features:[{id:1,name:"Create Fundraisers",icon:"fa fa-bullhorn",requiredStage:"Basic Info",unlocked:!0},{id:2,name:"Receive Donations",icon:"fa fa-hand-holding-heart",requiredStage:"Documents",unlocked:!0},{id:3,name:"Payout to Beneficiaries",icon:"fa fa-money-bill-wave",requiredStage:"Bank Verification",unlocked:!1,pending:!0},{id:4,name:"Payouts > ₦1,000,000",icon:"fa fa-wallet",requiredStage:"Full KYC",unlocked:!1},{id:5,name:"Partner Integrations",icon:"fa fa-handshake",requiredStage:"Full KYC",unlocked:!1}],beneficiariesNeedingKYC:8,beneficiariesPendingKYC:[{id:1,name:"Jane Doe",reference:"BEN-001",kycStatus:"not_started"},{id:2,name:"John Kamara",reference:"BEN-002",kycStatus:"in_progress"},{id:3,name:"Mary Johnson",reference:"BEN-003",kycStatus:"not_started"}]}},computed:{overallCompletion(){const n=this.stages.length,t=this.stages.filter(u=>u.status==="verified").length,_=this.stages.filter(u=>["in_progress","pending_review"].includes(u.status)).length;return Math.round((t+_*.5)/n*100)},completionBadgeClass(){return this.overallCompletion===100?"bg-success":this.overallCompletion>=50?"bg-warning text-dark":"bg-secondary"},canSubmitStage(){return!(!this.selectedStage||this.selectedStage.requirements&&!this.selectedStage.requirements.every(t=>t.completed)||this.selectedStage.requiredDocuments&&!this.selectedStage.requiredDocuments.every(t=>t.uploaded))}},methods:{getInitials(n){return n?n.split(" ").map(t=>t[0]).join("").toUpperCase().slice(0,2):"?"},formatDate(n){return n?new Date(n).toLocaleDateString():""},selectStage(n){const t=this.stages.findIndex(u=>u.id===n.id);(this.stages.slice(0,t).every(u=>u.status==="verified")||n.status!=="not_started")&&(this.selectedStage=n)},uploadDocument(n){n.uploaded=!0,n.fileName=`${n.name.toLowerCase().replace(/\s/g,"_")}.pdf`;const t=this.selectedStage;if(t.requirements){const _=t.requirements.find(u=>u.label.toLowerCase().includes(n.name.toLowerCase()));_&&(_.completed=!0)}},removeDocument(n){n.uploaded=!1,n.fileName=null},async submitStage(){this.submitting=!0;try{await new Promise(n=>setTimeout(n,1500)),this.selectedStage.status="pending_review",this.selectedStage.submittedAt=new Date,alert("Stage submitted for review")}finally{this.submitting=!1}},resubmitStage(n){n.status="in_progress",n.rejectionReason=null},requestBeneficiaryKYC(n){alert(`KYC request sent to ${n.name}`)}},mounted(){this.selectedStage=this.stages.find(n=>n.status==="in_progress")||this.stages.find(n=>n.status==="pending_review")||this.stages.find(n=>n.status==="not_started")}},V={class:"kyc-management"},I={class:"page-header mb-4"},P={class:"row align-items-center"},U={class:"col-md-4 text-md-end"},j={class:"overall-progress"},z={class:"kyc-stages-card card shadow-none border mb-4"},M={class:"card-body"},L={class:"stages-wrapper"},T=["onClick"],E={key:0,class:"stage-connector"},O={class:"stage-circle"},G={key:0,class:"fa fa-check"},J={key:1,class:"fa fa-times"},H={key:2,class:"fa fa-clock"},Q={key:3,class:"fa fa-edit"},W={key:4,class:"fa fa-lock"},X={class:"stage-label"},Z={class:"row"},$={class:"col-lg-5 mb-4"},ee={class:"card shadow-none border h-[100%]"},te={class:"card-body p-0"},se={class:"table table-sm mb-0"},ie={class:"d-flex align-items-center"},ae={class:"badge bg-light text-dark"},ne={class:"text-end"},oe={key:0,class:"text-success"},le={key:1,class:"text-warning"},re={key:2,class:"text-muted"},de={class:"col-lg-7 mb-4"},ce={class:"card shadow-none border h-[100%]"},ue={class:"card-header bg-white d-flex justify-content-between align-items-center"},me={class:"mb-0 text-foreground"},fe={class:"card-body"},pe={key:0,class:"text-center py-4"},ge={class:"text-muted mb-0"},_e={key:1,class:"rejection-info"},be={class:"alert alert-danger"},ve={class:"mb-2"},he={class:"text-muted"},ye={key:2,class:"text-center py-4"},ke={class:"text-muted mb-3"},xe={key:3,class:"stage-form"},Ce={class:"text-muted mb-4"},Se={class:"requirements-checklist mb-4"},we={class:"requirement-check me-2"},De={key:0,class:"text-muted"},qe={key:0,class:"documents-section mb-4"},Be={class:"d-flex justify-content-between align-items-center"},Fe={class:"fw-semibold"},Ne={class:"text-muted"},Ke={key:0,class:"text-success"},Re=["onClick"],Ye=["onClick"],Ae={key:1,class:"form-section mb-4"},Ve={class:"row g-3"},Ie={class:"form-label"},Pe={key:0,class:"text-danger"},Ue=["type","onUpdate:modelValue","placeholder"],je=["onUpdate:modelValue"],ze={value:""},Me=["value"],Le=["onUpdate:modelValue","placeholder"],Te=["disabled"],Ee={key:0,class:"fa fa-spinner fa-spin me-1"},Oe={key:1,class:"fa fa-paper-plane me-1"},Ge={key:4,class:"text-center py-4 text-muted"},Je={class:"card shadow-none border"},He={class:"card-header bg-white d-flex justify-content-between align-items-center"},Qe={class:"badge bg-warning text-dark"},We={class:"card-body"},Xe={key:0,class:"beneficiary-kyc-list"},Ze={class:"d-flex align-items-center"},$e={class:"avatar-sm me-2"},et={class:"fw-semibold"},tt={class:"text-muted"},st={class:"d-flex align-items-center gap-2"},it=["onClick"],at={key:1,class:"text-center py-3 text-muted"},nt={class:"text-end mt-3"};function ot(n,t,_,u,o,d){var k,x,C;const v=h("status-badge"),w=h("permission-gate"),D=h("router-link");return i(),a("div",V,[e("div",I,[e("div",P,[t[3]||(t[3]=e("div",{class:"col-md-8"},[e("h4",{class:"mb-1 text-foreground"},"KYC Management"),e("p",{class:"text-muted mb-0"},"Manage organization verification and unlock features")],-1)),e("div",U,[e("div",j,[t[2]||(t[2]=e("span",{class:"text-muted me-2"},"Overall Completion",-1)),e("span",{class:m(["badge",d.completionBadgeClass])},l(d.overallCompletion)+"%",3)])])])]),e("div",z,[e("div",M,[e("div",L,[(i(!0),a(f,null,p(o.stages,(s,c)=>(i(),a("div",{key:s.id,class:m(["stage-item",{completed:s.status==="verified",current:s.status==="in_progress",locked:s.status==="not_started"}]),onClick:lt=>d.selectStage(s)},[c>0?(i(),a("div",E)):g("",!0),e("div",O,[s.status==="verified"?(i(),a("i",G)):s.status==="rejected"?(i(),a("i",J)):s.status==="pending_review"?(i(),a("i",H)):s.status==="in_progress"?(i(),a("i",Q)):(i(),a("i",W))]),e("div",X,l(s.name),1),b(v,{status:s.status,type:"kyc",size:"sm",class:"mt-1"},null,8,["status"])],10,T))),128))])])]),e("div",Z,[e("div",$,[e("div",ee,[t[8]||(t[8]=e("div",{class:"card-header bg-white"},[e("h6",{class:"mb-0 text-foreground"},[e("i",{class:"fa fa-unlock-alt me-2"}),r(" Feature Access ")])],-1)),e("div",te,[e("table",se,[t[7]||(t[7]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{class:"border-0"},"Feature"),e("th",{class:"border-0"},"Required"),e("th",{class:"border-0 text-end"},"Status")])],-1)),e("tbody",null,[(i(!0),a(f,null,p(o.features,s=>(i(),a("tr",{key:s.id},[e("td",null,[e("div",ie,[e("i",{class:m([s.icon,"me-2 text-muted"])},null,2),r(" "+l(s.name),1)])]),e("td",null,[e("span",ae,l(s.requiredStage),1)]),e("td",ne,[s.unlocked?(i(),a("span",oe,[...t[4]||(t[4]=[e("i",{class:"fa fa-check-circle"},null,-1),r(" Enabled ",-1)])])):s.pending?(i(),a("span",le,[...t[5]||(t[5]=[e("i",{class:"fa fa-clock"},null,-1),r(" Pending ",-1)])])):(i(),a("span",re,[...t[6]||(t[6]=[e("i",{class:"fa fa-lock"},null,-1),r(" Locked ",-1)])]))])]))),128))])])])])]),e("div",de,[e("div",ce,[e("div",ue,[e("h6",me,[t[9]||(t[9]=e("i",{class:"fa fa-clipboard-check me-2"},null,-1)),r(" "+l(o.selectedStage?o.selectedStage.name:"Next Step"),1)]),o.selectedStage?(i(),N(v,{key:0,status:o.selectedStage.status,type:"kyc"},null,8,["status"])):g("",!0)]),e("div",fe,[((k=o.selectedStage)==null?void 0:k.status)==="verified"?(i(),a("div",pe,[t[10]||(t[10]=e("div",{class:"success-icon mb-3"},[e("i",{class:"fa fa-check-circle text-success",style:{"font-size":"3rem"}})],-1)),t[11]||(t[11]=e("h5",{class:"text-success"},"Verified",-1)),e("p",ge," Completed on "+l(d.formatDate(o.selectedStage.verifiedAt)),1)])):((x=o.selectedStage)==null?void 0:x.status)==="rejected"?(i(),a("div",_e,[e("div",be,[t[12]||(t[12]=e("h6",null,[e("i",{class:"fa fa-times-circle me-2"}),r("Verification Rejected")],-1)),e("p",ve,l(o.selectedStage.rejectionReason),1),e("small",he,"Rejected on "+l(d.formatDate(o.selectedStage.rejectedAt)),1)]),e("button",{class:"btn btn-danger w-[100%]",onClick:t[0]||(t[0]=s=>d.resubmitStage(o.selectedStage))},[...t[13]||(t[13]=[e("i",{class:"fa fa-redo me-1"},null,-1),r(" Fix & Resubmit ",-1)])])])):((C=o.selectedStage)==null?void 0:C.status)==="pending_review"?(i(),a("div",ye,[t[14]||(t[14]=e("div",{class:"pending-icon mb-3"},[e("i",{class:"fa fa-clock text-warning",style:{"font-size":"3rem"}})],-1)),t[15]||(t[15]=e("h5",{class:"text-warning"},"Under Review",-1)),e("p",ke," Submitted on "+l(d.formatDate(o.selectedStage.submittedAt)),1),t[16]||(t[16]=e("p",{class:"text-muted small"}," Average review time: 1-2 business days ",-1))])):o.selectedStage?(i(),a("div",xe,[e("p",Ce,l(o.selectedStage.description),1),e("div",Se,[t[17]||(t[17]=e("h6",{class:"text-foreground mb-3"},"Requirements",-1)),(i(!0),a(f,null,p(o.selectedStage.requirements,s=>(i(),a("div",{key:s.id,class:"requirement-item d-flex align-items-start mb-2"},[e("div",we,[e("i",{class:m(["fa",s.completed?"fa-check-circle text-success":"fa-circle text-muted"])},null,2)]),e("div",null,[e("div",{class:m({"text-muted text-decoration-line-through":s.completed})},l(s.label),3),s.hint?(i(),a("small",De,l(s.hint),1)):g("",!0)])]))),128))]),o.selectedStage.documentsRequired?(i(),a("div",qe,[t[21]||(t[21]=e("h6",{class:"text-foreground mb-3"},"Upload Documents",-1)),(i(!0),a(f,null,p(o.selectedStage.requiredDocuments,s=>(i(),a("div",{key:s.id,class:m(["document-upload-item p-3 border rounded mb-2",{"border-success":s.uploaded}])},[e("div",Be,[e("div",null,[e("div",Fe,l(s.name),1),e("small",Ne,l(s.description),1)]),s.uploaded?(i(),a("div",Ke,[t[19]||(t[19]=e("i",{class:"fa fa-check-circle me-1"},null,-1)),r(" "+l(s.fileName)+" ",1),e("button",{class:"btn btn-sm btn-link text-danger",onClick:c=>d.removeDocument(s)},[...t[18]||(t[18]=[e("i",{class:"fa fa-times"},null,-1)])],8,Re)])):(i(),a("button",{key:1,class:"btn btn-sm btn-outline-success",onClick:c=>d.uploadDocument(s)},[...t[20]||(t[20]=[e("i",{class:"fa fa-upload me-1"},null,-1),r(" Upload ",-1)])],8,Ye))])],2))),128))])):g("",!0),o.selectedStage.hasForm?(i(),a("div",Ae,[e("div",Ve,[(i(!0),a(f,null,p(o.selectedStage.formFields,s=>(i(),a("div",{key:s.id,class:m(s.colClass||"col-12")},[e("label",Ie,[r(l(s.label)+" ",1),s.required?(i(),a("span",Pe,"*")):g("",!0)]),s.type==="text"||s.type==="email"?y((i(),a("input",{key:0,type:s.type,class:"form-control","onUpdate:modelValue":c=>o.stageFormData[s.id]=c,placeholder:s.placeholder},null,8,Ue)),[[K,o.stageFormData[s.id]]]):s.type==="select"?y((i(),a("select",{key:1,class:"form-select","onUpdate:modelValue":c=>o.stageFormData[s.id]=c},[e("option",ze,l(s.placeholder),1),(i(!0),a(f,null,p(s.options,c=>(i(),a("option",{key:c.value,value:c.value},l(c.label),9,Me))),128))],8,je)),[[R,o.stageFormData[s.id]]]):s.type==="textarea"?y((i(),a("textarea",{key:2,class:"form-control","onUpdate:modelValue":c=>o.stageFormData[s.id]=c,placeholder:s.placeholder,rows:"3"},null,8,Le)),[[Y,o.stageFormData[s.id]]]):g("",!0)],2))),128))])])):g("",!0),b(w,{requires:"kyc:submit","user-permissions":o.userPermissions,"user-role":o.userRole},{default:S(()=>[e("button",{class:"btn btn-success w-[100%]",onClick:t[1]||(t[1]=(...s)=>d.submitStage&&d.submitStage(...s)),disabled:!d.canSubmitStage||o.submitting},[o.submitting?(i(),a("i",Ee)):(i(),a("i",Oe)),t[22]||(t[22]=r(" Submit for Review ",-1))],8,Te)]),_:1},8,["user-permissions","user-role"])])):(i(),a("div",Ge,[...t[23]||(t[23]=[e("i",{class:"fa fa-lock mb-3",style:{"font-size":"3rem"}},null,-1),e("p",{class:"mb-0"},"Complete previous stages to unlock this step.",-1)])]))])])])]),e("div",Je,[e("div",He,[t[24]||(t[24]=e("h6",{class:"mb-0 text-foreground"},[e("i",{class:"fa fa-users me-2"}),r(" Beneficiary KYC Status ")],-1)),e("span",Qe,l(o.beneficiariesNeedingKYC)+" awaiting verification ",1)]),e("div",We,[t[27]||(t[27]=e("p",{class:"text-muted mb-3"}," Beneficiaries require KYC verification to receive payouts above ₦50,000. ",-1)),o.beneficiariesNeedingKYC>0?(i(),a("div",Xe,[(i(!0),a(f,null,p(o.beneficiariesPendingKYC,s=>(i(),a("div",{key:s.id,class:"d-flex justify-content-between align-items-center py-2 border-bottom"},[e("div",Ze,[e("div",$e,l(d.getInitials(s.name)),1),e("div",null,[e("div",et,l(s.name),1),e("small",tt,l(s.reference),1)])]),e("div",st,[b(v,{status:s.kycStatus,type:"kyc",size:"sm"},null,8,["status"]),e("button",{class:"btn btn-sm btn-outline-success",onClick:c=>d.requestBeneficiaryKYC(s)}," Request KYC ",8,it)])]))),128))])):(i(),a("div",at,[...t[25]||(t[25]=[e("i",{class:"fa fa-check-circle text-success me-1"},null,-1),r(" All beneficiaries are verified. ",-1)])])),e("div",nt,[b(D,{to:"/beneficiaries",class:"btn btn-sm btn-outline-secondary"},{default:S(()=>[...t[26]||(t[26]=[r(" View All Beneficiaries ",-1),e("i",{class:"fa fa-arrow-right ms-1"},null,-1)])]),_:1})])])])])}const ut=F(A,[["render",ot],["__scopeId","data-v-9d72e885"]]);export{ut as default};
