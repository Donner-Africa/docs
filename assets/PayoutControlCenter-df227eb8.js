import{M as E}from"./Modal-e50977d8.js";import{P as U}from"./PermissionGate-64eadd35.js";import{S as F}from"./StatusBadge-51227ecd.js";import{l as I,a as i,f as r,b as t,n as m,t as o,e as c,h as d,F as h,g,P as N,r as P,c as C,w as p,v,z as B,d as x,s as A,x as R,y as _,m as V}from"./index-7b07f307.js";import{C as z}from"./ConfirmationModal-3f3021f1.js";import{f as D}from"./FormUtility-a2bc7d0b.js";const L={name:"BalanceSummary",props:{available:{type:Number,default:0},committed:{type:Number,default:0},pending:{type:Number,default:0},total:{type:Number,default:0},currency:{type:String,default:"₦"},availableChange:{type:Number,default:null},pendingPayouts:{type:Number,default:null},pendingDonations:{type:Number,default:null},lastUpdated:{type:[String,Date],default:null},lowBalanceThreshold:{type:Number,default:1e5},breakdown:{type:Array,default:()=>[]},compact:{type:Boolean,default:!1},showBreakdown:{type:Boolean,default:!1},showRefresh:{type:Boolean,default:!0},refreshing:{type:Boolean,default:!1}},computed:{showLowBalanceWarning(){return this.available<this.lowBalanceThreshold&&this.available>0}},methods:{formatCurrency(a){if(a==null)return`${this.currency}0`;const e=Math.abs(a);let u;return e>=1e6?u=(e/1e6).toFixed(1)+"M":e>=1e3?u=(e/1e3).toFixed(1)+"K":u=e.toLocaleString(),(a<0?"-":"")+this.currency+u},formatPercentage(a){return a===null?"":`${a>0?"+":""}${a.toFixed(1)}%`},formatRelativeTime(a){if(!a)return"";const e=new Date(a),y=new Date-e,s=Math.floor(y/6e4);if(s<1)return"just now";if(s<60)return`${s}m ago`;const n=Math.floor(y/36e5);return n<24?`${n}h ago`:e.toLocaleDateString()},changeClass(a){return a>0?"change-positive":a<0?"change-negative":"change-neutral"},changeIcon(a){return a>0?"fa fa-arrow-up":a<0?"fa fa-arrow-down":"fa fa-minus"}}},K={class:"balance-grid"},Q={class:"balance-card balance-available"},j={class:"balance-info"},Y={class:"balance-card balance-committed"},J={class:"balance-info"},O={class:"balance-value"},H={key:0,class:"balance-meta"},W={class:"balance-card balance-pending"},G={class:"balance-info"},X={class:"balance-value"},Z={key:0,class:"balance-meta"},$={class:"balance-card balance-total"},ee={class:"balance-info"},te={class:"balance-value"},se={key:0,class:"balance-meta"},le={key:0,class:"low-balance-alert"},ne={key:1,class:"balance-breakdown mt-3"},ae={class:"breakdown-list"},oe={class:"breakdown-name"},ie={class:"breakdown-value"},re={class:"breakdown-bar"},ue={key:2,class:"balance-refresh mt-3 text-end"},de=["disabled"];function ce(a,e,u,y,s,n){return i(),r("div",{class:m(["balance-summary",{compact:u.compact}])},[t("div",K,[t("div",Q,[e[2]||(e[2]=t("div",{class:"balance-icon"},[t("i",{class:"fa fa-wallet"})],-1)),t("div",j,[e[1]||(e[1]=t("span",{class:"balance-label"},"Available",-1)),t("span",{class:m(["balance-value",{"text-danger":u.available<0}])},o(n.formatCurrency(u.available)),3),u.availableChange!==null?(i(),r("span",{key:0,class:m(["balance-change",n.changeClass(u.availableChange)])},[t("i",{class:m(n.changeIcon(u.availableChange))},null,2),c(" "+o(n.formatPercentage(u.availableChange)),1)],2)):d("",!0)])]),t("div",Y,[e[4]||(e[4]=t("div",{class:"balance-icon"},[t("i",{class:"fa fa-lock"})],-1)),t("div",J,[e[3]||(e[3]=t("span",{class:"balance-label"},"Committed",-1)),t("span",O,o(n.formatCurrency(u.committed)),1),u.pendingPayouts?(i(),r("span",H,o(u.pendingPayouts)+" pending ",1)):d("",!0)])]),t("div",W,[e[6]||(e[6]=t("div",{class:"balance-icon"},[t("i",{class:"fa fa-clock"})],-1)),t("div",G,[e[5]||(e[5]=t("span",{class:"balance-label"},"Pending",-1)),t("span",X,o(n.formatCurrency(u.pending)),1),u.pendingDonations?(i(),r("span",Z,o(u.pendingDonations)+" donations ",1)):d("",!0)])]),t("div",$,[e[8]||(e[8]=t("div",{class:"balance-icon"},[t("i",{class:"fa fa-chart-pie"})],-1)),t("div",ee,[e[7]||(e[7]=t("span",{class:"balance-label"},"Total",-1)),t("span",te,o(n.formatCurrency(u.total)),1),u.lastUpdated?(i(),r("span",se," Updated "+o(n.formatRelativeTime(u.lastUpdated)),1)):d("",!0)])])]),n.showLowBalanceWarning?(i(),r("div",le,[e[11]||(e[11]=t("i",{class:"fa fa-exclamation-triangle me-2"},null,-1)),t("span",null,[e[9]||(e[9]=c(" Available balance is below ",-1)),t("strong",null,o(n.formatCurrency(u.lowBalanceThreshold)),1),e[10]||(e[10]=c(". Some payouts may be blocked. ",-1))])])):d("",!0),u.showBreakdown&&u.breakdown.length?(i(),r("div",ne,[e[12]||(e[12]=t("h6",{class:"breakdown-title"},[t("i",{class:"fa fa-list me-2"}),c(" Balance by Fundraiser ")],-1)),t("div",ae,[(i(!0),r(h,null,g(u.breakdown,k=>(i(),r("div",{key:k.id,class:"breakdown-item"},[t("span",oe,o(k.name),1),t("span",ie,o(n.formatCurrency(k.amount)),1),t("div",re,[t("div",{class:"breakdown-bar-fill",style:N({width:`${k.amount/u.total*100}%`})},null,4)])]))),128))])])):d("",!0),u.showRefresh?(i(),r("div",ue,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:e[0]||(e[0]=k=>a.$emit("refresh")),disabled:u.refreshing},[t("i",{class:m(["fa",u.refreshing?"fa-spinner fa-spin":"fa-sync-alt","me-1"])},null,2),e[13]||(e[13]=c(" Refresh ",-1))],8,de)])):d("",!0)],2)}const me=I(L,[["render",ce],["__scopeId","data-v-5b71d803"]]);const fe={name:"PayoutModal",components:{Modal:E},props:{show:{type:Boolean,default:!1},payout:{type:Object,default:()=>({})},balance:{type:Number,default:0}},data(){return{step:1,executing:!1,showAllItems:!1,confirmations:{authorized:!1,irreversible:!1,blockers:!1}}},computed:{isBulk(){var a;return((a=this.payout)==null?void 0:a.isBulk)||!1},totalAmount(){var a,e;return this.isBulk?((a=this.payout)==null?void 0:a.totalAmount)||0:((e=this.payout)==null?void 0:e.amount)||0},effectiveAmount(){var a,e;return this.isBulk&&((a=this.payout)!=null&&a.items)?this.payout.items.filter(u=>!u.hasBlockers).reduce((u,y)=>u+y.amount,0):(e=this.payout)!=null&&e.hasBlockers?0:this.totalAmount},estimatedFee(){const a=this.effectiveAmount;return a<5e3?10:a<5e4?25:a<5e5?50:Math.min(100,Math.ceil(a*1e-4))},balanceAfter(){return this.balance-this.effectiveAmount-this.estimatedFee},blockers(){var a,e;return this.isBulk&&((a=this.payout)!=null&&a.items)?this.payout.items.filter(u=>u.hasBlockers).map(u=>({recipient:u.recipientName,reason:u.blockerReason})):(e=this.payout)!=null&&e.hasBlockers?[{recipient:this.payout.recipientName,reason:this.payout.blockerReason}]:[]},validRecipientCount(){var a,e;return this.isBulk&&((a=this.payout)!=null&&a.items)?this.payout.items.filter(u=>!u.hasBlockers).length:(e=this.payout)!=null&&e.hasBlockers?0:1},requiresDualControl(){return this.effectiveAmount>=1e6},displayedItems(){var a;return(a=this.payout)!=null&&a.items?this.showAllItems?this.payout.items:this.payout.items.slice(0,5):[]},canProceed(){return this.step===2?this.balanceAfter>=0&&this.validRecipientCount>0:!0},canExecute(){const a=this.confirmations.authorized&&this.confirmations.irreversible;return this.blockers.length>0?a&&this.confirmations.blockers:a}},watch:{show(a){a&&(this.step=1,this.confirmations={authorized:!1,irreversible:!1,blockers:!1},this.showAllItems=!1)}},methods:{formatAmount:D,async execute(){var a;this.executing=!0;try{await new Promise(e=>setTimeout(e,2e3)),this.$emit("execute",{payoutId:(a=this.payout)==null?void 0:a.id,amount:this.effectiveAmount,validRecipients:this.validRecipientCount})}catch(e){alert("Execution failed: "+e.message)}finally{this.executing=!1}}}},be={class:"modal-title d-flex align-items-center"},ye={class:"step-indicator me-3"},pe={class:"badge bg-secondary ms-2"},ve={class:"payout-modal-content"},he={key:0,class:"step-content"},ge={class:"summary-card p-4 bg-light rounded mb-4"},ke={class:"row"},we={class:"col-md-6"},xe={class:"summary-item mb-3"},Pe={class:"text-muted small"},_e={class:"fw-bold text-dark"},Ce={class:"summary-item mb-3"},Ae={class:"col-md-6 text-md-end"},Be={class:"summary-item mb-3"},Te={class:"h4 text-success mb-0"},Se={class:"summary-item"},Me={class:"fw-bold"},Re={key:0,class:"recipients-breakdown mb-4"},Ie={class:"breakdown-table"},qe={class:"flex-grow-1"},Ee={key:0,class:"text-danger d-block"},De={style:{width:"100px"}},Ue={class:"badge bg-light text-dark"},Fe={class:"text-end fw-semibold",style:{width:"120px"}},Ne={key:0,class:"text-center py-2"},Ve={key:1,class:"blockers-section mb-4"},ze={class:"alert alert-warning mb-0"},Le={class:"alert-heading"},Ke={class:"mb-0 ps-3"},Qe={key:0,class:"mt-3"},je={class:"text-muted"},Ye={key:1,class:"step-content"},Je={class:"balance-simulation p-4 bg-light rounded mb-4"},Oe={class:"row align-items-center"},He={class:"col-5 text-center"},We={class:"h4 mb-0"},Ge={class:"col-5 text-center"},Xe={class:"row text-center"},Ze={class:"col-4"},$e={class:"fw-bold text-danger"},et={class:"col-4"},tt={class:"fw-bold text-danger"},st={class:"col-4"},lt={class:"fw-bold text-danger"},nt={key:0,class:"alert alert-danger"},at={key:2,class:"step-content"},ot={class:"final-summary p-4 border rounded mb-4"},it={class:"row mb-3"},rt={class:"col-6 text-end fw-bold"},ut={class:"row mb-3"},dt={class:"col-6 text-end fw-bold text-success"},ct={class:"row mb-3"},mt={class:"col-6 text-end fw-bold"},ft={class:"row"},bt={class:"col-6 text-end h5 text-success mb-0"},yt={key:0,class:"alert alert-warning mb-4"},pt={class:"confirmations mb-4"},vt={class:"form-check mb-3"},ht={class:"form-check mb-3"},gt={key:0,class:"form-check"},kt={class:"form-check-label text-dark",for:"confirm3"},wt={class:"d-flex justify-content-between w-100"},xt=["disabled"],Pt=["disabled"],_t=["disabled"],Ct={key:0,class:"fa fa-spinner fa-spin me-1"};function At(a,e,u,y,s,n){const k=P("modal");return i(),C(k,{show:u.show,"onUpdate:show":e[7]||(e[7]=f=>a.$emit("update:show",f)),onClose:e[8]||(e[8]=f=>a.$emit("close")),"modal-classes":"modal-lg","show-close":!s.executing},{header:p(()=>[t("h5",be,[t("div",ye,[(i(),r(h,null,g(3,f=>t("span",{key:f,class:m(["step-dot",{active:s.step>=f,current:s.step===f}])},null,2)),64))]),e[9]||(e[9]=c(" Execute Payout ",-1)),t("span",pe,"Step "+o(s.step)+" of 3",1)])]),footer:p(()=>[t("div",wt,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:e[4]||(e[4]=f=>s.step>1?s.step--:a.$emit("close")),disabled:s.executing},o(s.step>1?"Back":"Cancel"),9,xt),s.step<3?(i(),r("button",{key:0,type:"button",class:"btn btn-success",onClick:e[5]||(e[5]=f=>s.step++),disabled:!n.canProceed},[...e[37]||(e[37]=[c(" Continue ",-1),t("i",{class:"fa fa-arrow-right ms-1"},null,-1)])],8,Pt)):(i(),r("button",{key:1,type:"button",class:"btn btn-success",onClick:e[6]||(e[6]=(...f)=>n.execute&&n.execute(...f)),disabled:!n.canExecute||s.executing},[s.executing?(i(),r("i",Ct)):d("",!0),c(" "+o(s.executing?"Executing...":`Execute ${n.validRecipientCount} Payout${n.validRecipientCount>1?"s":""}`),1)],8,_t))])]),default:p(()=>{var f,T,S;return[t("div",ve,[s.step===1?(i(),r("div",he,[e[17]||(e[17]=t("h6",{class:"text-dark mb-4"},"Review Payout Details",-1)),t("div",ge,[t("div",ke,[t("div",we,[t("div",xe,[t("label",Pe,"Recipient"+o(n.isBulk?"s":""),1),t("div",_e,o(n.isBulk?`${(f=u.payout)==null?void 0:f.recipientCount} recipients`:(T=u.payout)==null?void 0:T.recipientName),1)]),t("div",Ce,[e[10]||(e[10]=t("label",{class:"text-muted small"},"Type",-1)),t("div",null,[t("span",{class:m(["badge",n.isBulk?"bg-info":"bg-secondary"])},o(n.isBulk?"Bulk Payout":"Single Payout"),3)])])]),t("div",Ae,[t("div",Be,[e[11]||(e[11]=t("label",{class:"text-muted small"},"Total Amount",-1)),t("div",Te," ₦"+o(n.formatAmount(n.totalAmount)),1)]),t("div",Se,[e[12]||(e[12]=t("label",{class:"text-muted small"},"Estimated Fee",-1)),t("div",Me,"₦"+o(n.formatAmount(n.estimatedFee)),1)])])])]),n.isBulk&&u.payout.items?(i(),r("div",Re,[e[15]||(e[15]=t("h6",{class:"text-dark mb-3"},"Recipients Breakdown",-1)),t("div",Ie,[e[14]||(e[14]=t("div",{class:"breakdown-header d-flex py-2 border-bottom"},[t("div",{class:"flex-grow-1 text-muted small"},"Recipient"),t("div",{class:"text-muted small",style:{width:"100px"}},"Type"),t("div",{class:"text-muted small text-end",style:{width:"120px"}},"Amount")],-1)),(i(!0),r(h,null,g(n.displayedItems,b=>(i(),r("div",{key:b.id,class:m(["breakdown-row d-flex py-2 border-bottom",{"bg-danger-soft":b.hasBlockers}])},[t("div",qe,[t("span",null,o(b.recipientName),1),b.hasBlockers?(i(),r("small",Ee,[e[13]||(e[13]=t("i",{class:"fa fa-exclamation-triangle me-1"},null,-1)),c(o(b.blockerReason),1)])):d("",!0)]),t("div",De,[t("span",Ue,o(b.recipientType),1)]),t("div",Fe," ₦"+o(n.formatAmount(b.amount)),1)],2))),128)),((S=u.payout.items)==null?void 0:S.length)>5?(i(),r("div",Ne,[t("button",{class:"btn btn-sm btn-link",onClick:e[0]||(e[0]=b=>s.showAllItems=!s.showAllItems)},o(s.showAllItems?"Show Less":`Show All (${u.payout.items.length})`),1)])):d("",!0)])])):d("",!0),n.blockers.length>0?(i(),r("div",Ve,[t("div",ze,[t("h6",Le,[e[16]||(e[16]=t("i",{class:"fa fa-exclamation-triangle me-2"},null,-1)),c(" "+o(n.blockers.length)+" Blocker"+o(n.blockers.length>1?"s":"")+" Detected ",1)]),t("ul",Ke,[(i(!0),r(h,null,g(n.blockers,(b,M)=>(i(),r("li",{key:M,class:"mb-1"},[t("strong",null,o(b.recipient)+":",1),c(" "+o(b.reason),1)]))),128))]),n.isBulk?(i(),r("div",Qe,[t("small",je," These recipients will be skipped. "+o(n.validRecipientCount)+" of "+o(u.payout.recipientCount)+" will receive payouts. ",1)])):d("",!0)])])):d("",!0)])):d("",!0),s.step===2?(i(),r("div",Ye,[e[26]||(e[26]=t("h6",{class:"text-dark mb-4"},"Balance Impact Simulation",-1)),e[27]||(e[27]=t("div",{class:"alert alert-danger d-flex align-items-center mb-4"},[t("i",{class:"fa fa-exclamation-circle me-2",style:{"font-size":"1.5rem"}}),t("div",null,[t("strong",null,"THIS ACTION IS IRREVERSIBLE"),t("div",{class:"small"},"Once executed, funds cannot be recovered automatically.")])],-1)),t("div",Je,[t("div",Oe,[t("div",He,[e[18]||(e[18]=t("div",{class:"text-muted small mb-1"},"Current Available",-1)),t("div",We,"₦"+o(n.formatAmount(u.balance)),1)]),e[20]||(e[20]=t("div",{class:"col-2 text-center"},[t("i",{class:"fa fa-arrow-right text-muted",style:{"font-size":"1.5rem"}})],-1)),t("div",Ge,[e[19]||(e[19]=t("div",{class:"text-muted small mb-1"},"After Execution",-1)),t("div",{class:m(["h4 mb-0",n.balanceAfter<0?"text-danger":"text-success"])}," ₦"+o(n.formatAmount(n.balanceAfter)),3)])]),e[24]||(e[24]=t("hr",{class:"my-4"},null,-1)),t("div",Xe,[t("div",Ze,[e[21]||(e[21]=t("div",{class:"text-muted small"},"Payout Amount",-1)),t("div",$e,"- ₦"+o(n.formatAmount(n.effectiveAmount)),1)]),t("div",et,[e[22]||(e[22]=t("div",{class:"text-muted small"},"Fees",-1)),t("div",tt,"- ₦"+o(n.formatAmount(n.estimatedFee)),1)]),t("div",st,[e[23]||(e[23]=t("div",{class:"text-muted small"},"Total Deduction",-1)),t("div",lt,"- ₦"+o(n.formatAmount(n.effectiveAmount+n.estimatedFee)),1)])])]),n.balanceAfter<0?(i(),r("div",nt,[...e[25]||(e[25]=[t("i",{class:"fa fa-ban me-2"},null,-1),t("strong",null,"Insufficient Funds:",-1),c(" This payout cannot be executed. Please add funds or reduce the payout amount. ",-1)])])):d("",!0)])):d("",!0),s.step===3?(i(),r("div",at,[e[36]||(e[36]=t("h6",{class:"text-dark mb-4"},"Final Confirmation",-1)),t("div",ot,[t("div",it,[e[28]||(e[28]=t("div",{class:"col-6 text-muted"},"Recipients",-1)),t("div",rt,o(n.validRecipientCount),1)]),t("div",ut,[e[29]||(e[29]=t("div",{class:"col-6 text-muted"},"Total Amount",-1)),t("div",dt,"₦"+o(n.formatAmount(n.effectiveAmount)),1)]),t("div",ct,[e[30]||(e[30]=t("div",{class:"col-6 text-muted"},"Total Fees",-1)),t("div",mt,"₦"+o(n.formatAmount(n.estimatedFee)),1)]),e[32]||(e[32]=t("hr",null,null,-1)),t("div",ft,[e[31]||(e[31]=t("div",{class:"col-6 text-muted fw-bold"},"Grand Total",-1)),t("div",bt,"₦"+o(n.formatAmount(n.effectiveAmount+n.estimatedFee)),1)])]),n.requiresDualControl?(i(),r("div",yt,[...e[33]||(e[33]=[t("i",{class:"fa fa-users me-2"},null,-1),t("strong",null,"Dual Control Required:",-1),c(" This payout exceeds ₦1,000,000 and requires approval from another authorized user. ",-1)])])):d("",!0),t("div",pt,[t("div",vt,[v(t("input",{type:"checkbox",class:"form-check-input",id:"confirm1","onUpdate:modelValue":e[1]||(e[1]=b=>s.confirmations.authorized=b)},null,512),[[B,s.confirmations.authorized]]),e[34]||(e[34]=t("label",{class:"form-check-label text-dark",for:"confirm1"}," I confirm this payout is authorized and all recipient details are correct ",-1))]),t("div",ht,[v(t("input",{type:"checkbox",class:"form-check-input",id:"confirm2","onUpdate:modelValue":e[2]||(e[2]=b=>s.confirmations.irreversible=b)},null,512),[[B,s.confirmations.irreversible]]),e[35]||(e[35]=t("label",{class:"form-check-label text-dark",for:"confirm2"}," I understand this action cannot be reversed once executed ",-1))]),n.blockers.length>0?(i(),r("div",gt,[v(t("input",{type:"checkbox",class:"form-check-input",id:"confirm3","onUpdate:modelValue":e[3]||(e[3]=b=>s.confirmations.blockers=b)},null,512),[[B,s.confirmations.blockers]]),t("label",kt," I acknowledge that "+o(n.blockers.length)+" recipient(s) will be skipped due to blockers ",1)])):d("",!0)])])):d("",!0)])]}),_:1},8,["show","show-close"])}const Bt=I(fe,[["render",At],["__scopeId","data-v-a0dea4e4"]]);const Tt={name:"PayoutControlCenter",components:{Modal:E,PermissionGate:U,StatusBadge:F,BalanceSummary:me,ConfirmationModal:z,PayoutModal:Bt},data(){return{loading:!0,refreshingBalance:!1,creatingPayout:!1,cancelling:!1,userRole:"ADMIN",userPermissions:["payout:view","payout:create","payout:approve","payout:execute","payout:cancel"],balances:{available:245e4,committed:35e4,pending:12e5,total:4e6,pendingPayoutCount:12,pendingDonationCount:5,lastUpdated:new Date,breakdown:[]},showBalanceBreakdown:!1,searchQuery:"",activeTab:"queue",filters:{type:"",dateRange:"",amountRange:""},statusTabs:[{label:"Queue",value:"queue",icon:"fa fa-hourglass-start"},{label:"Processing",value:"processing",icon:"fa fa-spinner"},{label:"Completed",value:"completed",icon:"fa fa-check-circle"},{label:"Failed",value:"failed",icon:"fa fa-times-circle"}],queueStats:{total:12,pendingApproval:3,readyToExecute:9,totalAmount:89e4},payouts:[],fundraisers:[],beneficiaries:[],vendors:[],selectedPayouts:[],selectAll:!1,currentPage:1,pageSize:15,totalCount:0,showSinglePayoutModal:!1,showBulkUploadModal:!1,showExecuteModal:!1,showCancelConfirm:!1,newPayout:{recipientType:"beneficiary",recipientId:"",fundraiserId:"",amount:"",paymentMethod:"bank_transfer",description:""},payoutToExecute:null,payoutToCancel:null}},computed:{totalPages(){return Math.ceil(this.totalCount/this.pageSize)},visiblePages(){const a=[],e=Math.max(1,this.currentPage-2),u=Math.min(this.totalPages,this.currentPage+2);for(let y=e;y<=u;y++)a.push(y);return a},availableRecipients(){return this.newPayout.recipientType==="beneficiary"?this.beneficiaries:this.vendors},estimatedFee(){const a=parseInt(this.newPayout.amount)||0;return a<5e3?10:a<5e4?25:50},balanceAfterPayout(){const a=parseInt(this.newPayout.amount)||0;return this.balances.available-a-this.estimatedFee},canCreatePayout(){return this.newPayout.recipientId&&this.newPayout.amount&&parseInt(this.newPayout.amount)>0&&this.balanceAfterPayout>=0},canSelectPayouts(){return["queue","failed"].includes(this.activeTab)},selectedTotalAmount(){return this.payouts.filter(a=>this.selectedPayouts.includes(a.id)).reduce((a,e)=>a+e.amount,0)}},watch:{activeTab(){this.currentPage=1,this.selectedPayouts=[],this.fetchPayouts()},currentPage(){this.fetchPayouts()}},methods:{formatAmount:D,formatRelativeTime(a){if(!a)return"";const e=new Date(a),y=new Date-e,s=Math.floor(y/6e4);if(s<1)return"Just now";if(s<60)return`${s}m ago`;const n=Math.floor(y/36e5);return n<24?`${n}h ago`:e.toLocaleDateString()},formatFullDate(a){return a?new Date(a).toLocaleString():""},getTabCount(a){return{queue:12,processing:3,completed:45,failed:2}[a]||0},canSelectPayout(a){return["queued","failed"].includes(a.status)&&!a.hasBlockers},toggleSelectAll(){this.selectAll?this.selectedPayouts=this.payouts.filter(a=>this.canSelectPayout(a)).map(a=>a.id):this.selectedPayouts=[]},async refreshAll(){await Promise.all([this.refreshBalances(),this.fetchPayouts()])},async refreshBalances(){this.refreshingBalance=!0;try{await new Promise(a=>setTimeout(a,500)),this.balances.lastUpdated=new Date}finally{this.refreshingBalance=!1}},async fetchPayouts(){this.loading=!0;try{await new Promise(a=>setTimeout(a,500)),this.payouts=[{id:1,reference:"PAY-001",batchId:null,isBulk:!1,recipientType:"beneficiary",recipientName:"Jane Doe",amount:5e4,fee:25,status:"queued",requiresApproval:!1,hasBlockers:!1,createdAt:new Date(Date.now()-36e5)},{id:2,reference:"PAY-002",batchId:"BATCH-001",isBulk:!0,recipientCount:15,recipientType:"beneficiary",recipientName:"Batch: 15 beneficiaries",amount:89e4,fee:375,status:"queued",requiresApproval:!0,hasBlockers:!1,createdAt:new Date(Date.now()-72e5)},{id:3,reference:"PAY-003",batchId:null,isBulk:!1,recipientType:"vendor",recipientName:"MedSupply Inc.",amount:12e4,fee:50,status:"queued",requiresApproval:!1,hasBlockers:!0,blockerReason:"Missing KYC",createdAt:new Date(Date.now()-864e5)}],this.totalCount=12,this.beneficiaries=[{id:1,name:"Jane Doe",blocked:!1},{id:2,name:"John Kamara",blocked:!0,blockReason:"KYC pending"},{id:3,name:"Mary Johnson",blocked:!1}],this.vendors=[{id:1,name:"MedSupply Inc.",blocked:!1},{id:2,name:"FastLog Delivery",blocked:!0,blockReason:"Suspended"}],this.fundraisers=[{id:1,title:"Medical Aid Campaign",availableBalance:15e5},{id:2,title:"Education Support",availableBalance:45e4}]}finally{this.loading=!1}},async createSinglePayout(){this.creatingPayout=!0;try{await new Promise(a=>setTimeout(a,1e3)),this.showSinglePayoutModal=!1,this.newPayout={recipientType:"beneficiary",recipientId:"",fundraiserId:"",amount:"",paymentMethod:"bank_transfer",description:""},this.fetchPayouts(),alert("Payout queued successfully")}finally{this.creatingPayout=!1}},openExecuteModal(a){this.payoutToExecute=a,this.showExecuteModal=!0},openBulkExecuteModal(){const a=this.payouts.filter(e=>this.selectedPayouts.includes(e.id));this.payoutToExecute={isBulk:!0,items:a,totalAmount:this.selectedTotalAmount,recipientCount:a.length},this.showExecuteModal=!0},async executePayout(a){try{await new Promise(e=>setTimeout(e,1500)),this.showExecuteModal=!1,this.selectedPayouts=[],this.fetchPayouts(),this.refreshBalances(),alert("Payout executed successfully")}catch(e){alert("Payout execution failed: "+e.message)}},cancelPayout(a){this.payoutToCancel=a,this.showCancelConfirm=!0},async confirmCancelPayout({reason:a}){this.cancelling=!0;try{await new Promise(e=>setTimeout(e,1e3)),this.showCancelConfirm=!1,this.payoutToCancel=null,this.fetchPayouts(),alert("Payout cancelled")}finally{this.cancelling=!1}},async approvePayout(a){await new Promise(e=>setTimeout(e,500)),this.fetchPayouts(),alert("Payout approved")},async retryPayout(a){alert("Retry payout - to be implemented")},viewReceipt(a){alert("View receipt - to be implemented")},viewDetails(a){alert("View details - to be implemented")},executeAllQueued(){alert("Execute all queued - to be implemented")},cancelSelected(){alert("Cancel selected - to be implemented")}},async mounted(){await this.fetchPayouts()}},St={class:"payout-control-center"},Mt={class:"page-header mb-4"},Rt={class:"row align-items-center"},It={class:"col-md-6 text-md-end mt-3 mt-md-0"},qt=["disabled"],Et={key:0,class:"queue-summary mb-4"},Dt={class:"alert alert-info d-flex align-items-center justify-content-between mb-0"},Ut={class:"text-warning"},Ft=["disabled"],Nt={class:"nav nav-pills mb-4"},Vt=["onClick"],zt={class:"card shadow-none border"},Lt={class:"card-body p-0"},Kt={class:"filter-row p-3 border-bottom bg-light"},Qt={class:"row g-2"},jt={class:"col-md-4"},Yt={class:"input-group input-group-sm"},Jt={class:"col-md-2"},Ot={class:"col-md-2"},Ht={class:"col-md-2"},Wt={key:0,class:"p-4"},Gt={key:1,class:"empty-state text-center py-6"},Xt={class:"text-muted mb-4"},Zt={key:2,class:"table-responsive"},$t={class:"table table-hover mb-0"},es={class:"table-light"},ts={class:"border-0"},ss=["disabled"],ls=["value","disabled"],ns={class:"fw-semibold text-dark"},as={key:0,class:"text-muted"},os={class:"d-flex align-items-center"},is={key:0,class:"text-danger"},rs={class:"text-end"},us={class:"fw-bold"},ds={key:0,class:"text-muted"},cs=["title"],ms={class:"text-end"},fs={class:"btn-group btn-group-sm"},bs=["onClick","disabled","title"],ys=["onClick"],ps=["onClick"],vs=["onClick"],hs=["onClick"],gs=["onClick"],ks={key:3,class:"bulk-actions-bar p-3 border-top bg-light"},ws={class:"d-flex justify-content-between align-items-center"},xs={class:"text-muted"},Ps={class:"btn-group"},_s={key:4,class:"p-3 border-top d-flex justify-content-between align-items-center"},Cs={class:"text-muted text-sm"},As={class:"pagination pagination-sm mb-0"},Bs=["onClick"],Ts={class:"row g-3"},Ss={class:"col-12"},Ms={class:"btn-group w-100"},Rs={class:"col-md-6"},Is={class:"form-label"},qs=["value","disabled"],Es={class:"col-md-6"},Ds=["value"],Us={class:"col-md-6"},Fs={class:"input-group"},Ns={key:0,class:"text-muted"},Vs={class:"col-md-6"},zs={class:"col-12"},Ls={key:0,class:"balance-impact mt-4 p-3 bg-light rounded"},Ks={class:"row"},Qs={class:"col-6"},js={class:"fw-bold"},Ys={class:"col-6"},Js={key:0,class:"alert alert-danger mt-3 mb-0"},Os=["disabled"],Hs={key:0,class:"fa fa-spinner fa-spin me-1"};function Ws(a,e,u,y,s,n){var q;const k=P("balance-summary"),f=P("permission-gate"),T=P("status-badge"),S=P("modal"),b=P("payout-modal"),M=P("confirmation-modal");return i(),r("div",St,[x(k,{available:s.balances.available,committed:s.balances.committed,pending:s.balances.pending,total:s.balances.total,"pending-payouts":s.balances.pendingPayoutCount,"pending-donations":s.balances.pendingDonationCount,"last-updated":s.balances.lastUpdated,refreshing:s.refreshingBalance,"show-breakdown":s.showBalanceBreakdown,breakdown:s.balances.breakdown,onRefresh:n.refreshBalances,class:"mb-4"},null,8,["available","committed","pending","total","pending-payouts","pending-donations","last-updated","refreshing","show-breakdown","breakdown","onRefresh"]),t("div",Mt,[t("div",Rt,[e[33]||(e[33]=t("div",{class:"col-md-6"},[t("h4",{class:"mb-1 text-dark"},"Payout Control Center"),t("p",{class:"text-muted mb-0"},"Execute single and bulk payouts with full audit trail")],-1)),t("div",It,[x(f,{requires:"payout:create","user-permissions":s.userPermissions,"user-role":s.userRole},{default:p(()=>[t("button",{class:"btn btn-success me-2",onClick:e[0]||(e[0]=l=>s.showSinglePayoutModal=!0)},[...e[30]||(e[30]=[t("i",{class:"fa fa-paper-plane me-1"},null,-1),c(" Single Payout ",-1)])]),t("button",{class:"btn btn-outline-success me-2",onClick:e[1]||(e[1]=l=>s.showBulkUploadModal=!0)},[...e[31]||(e[31]=[t("i",{class:"fa fa-upload me-1"},null,-1),c(" Bulk Upload ",-1)])])]),_:1},8,["user-permissions","user-role"]),t("button",{class:"btn btn-outline-secondary",onClick:e[2]||(e[2]=(...l)=>n.refreshAll&&n.refreshAll(...l)),disabled:s.loading},[t("i",{class:m(["fa",s.loading?"fa-spinner fa-spin":"fa-sync-alt","me-1"])},null,2),e[32]||(e[32]=c(" Refresh ",-1))],8,qt)])])]),s.queueStats.total>0?(i(),r("div",Et,[t("div",Dt,[t("div",null,[e[34]||(e[34]=t("i",{class:"fa fa-info-circle me-2"},null,-1)),t("strong",null,o(s.queueStats.total),1),e[35]||(e[35]=c(" payouts in queue ",-1)),e[36]||(e[36]=t("span",{class:"text-muted mx-2"},"|",-1)),t("span",Ut,o(s.queueStats.pendingApproval)+" awaiting approval",1),e[37]||(e[37]=t("span",{class:"text-muted mx-2"},"|",-1)),e[38]||(e[38]=c(" Total: ",-1)),t("strong",null,"₦"+o(n.formatAmount(s.queueStats.totalAmount)),1)]),x(f,{requires:"payout:execute","user-permissions":s.userPermissions,"user-role":s.userRole},{default:p(()=>[t("button",{class:"btn btn-sm btn-success",onClick:e[3]||(e[3]=(...l)=>n.executeAllQueued&&n.executeAllQueued(...l)),disabled:!s.queueStats.readyToExecute},[e[39]||(e[39]=t("i",{class:"fa fa-play me-1"},null,-1)),c(" Execute All Ready ("+o(s.queueStats.readyToExecute)+") ",1)],8,Ft)]),_:1},8,["user-permissions","user-role"])])])):d("",!0),t("ul",Nt,[(i(!0),r(h,null,g(s.statusTabs,l=>(i(),r("li",{class:"nav-item",key:l.value},[t("a",{class:m(["nav-link",{active:s.activeTab===l.value}]),href:"#",onClick:A(w=>s.activeTab=l.value,["prevent"])},[l.icon?(i(),r("i",{key:0,class:m([l.icon,"me-1"])},null,2)):d("",!0),c(" "+o(l.label)+" ",1),t("span",{class:m(["badge ms-1",[s.activeTab===l.value?"bg-white text-success":"bg-secondary",l.value==="failed"&&n.getTabCount(l.value)>0?"bg-danger":""]])},o(n.getTabCount(l.value)),3)],10,Vt)]))),128))]),t("div",zt,[t("div",Lt,[t("div",Kt,[t("div",Qt,[t("div",jt,[t("div",Yt,[e[40]||(e[40]=t("span",{class:"input-group-text bg-white"},[t("i",{class:"fa fa-search text-muted"})],-1)),v(t("input",{type:"text",class:"form-control",placeholder:"Search by recipient, batch ID...","onUpdate:modelValue":e[4]||(e[4]=l=>s.searchQuery=l)},null,512),[[R,s.searchQuery]])])]),t("div",Jt,[v(t("select",{class:"form-select form-select-sm","onUpdate:modelValue":e[5]||(e[5]=l=>s.filters.type=l)},[...e[41]||(e[41]=[t("option",{value:""},"All Types",-1),t("option",{value:"beneficiary"},"Beneficiary",-1),t("option",{value:"vendor"},"Vendor",-1)])],512),[[_,s.filters.type]])]),t("div",Ot,[v(t("select",{class:"form-select form-select-sm","onUpdate:modelValue":e[6]||(e[6]=l=>s.filters.dateRange=l)},[...e[42]||(e[42]=[t("option",{value:""},"All Time",-1),t("option",{value:"today"},"Today",-1),t("option",{value:"week"},"This Week",-1),t("option",{value:"month"},"This Month",-1)])],512),[[_,s.filters.dateRange]])]),t("div",Ht,[v(t("select",{class:"form-select form-select-sm","onUpdate:modelValue":e[7]||(e[7]=l=>s.filters.amountRange=l)},[...e[43]||(e[43]=[t("option",{value:""},"Any Amount",-1),t("option",{value:"under50k"},"Under ₦50K",-1),t("option",{value:"50k-500k"},"₦50K - ₦500K",-1),t("option",{value:"over500k"},"Over ₦500K",-1)])],512),[[_,s.filters.amountRange]])])])]),s.loading?(i(),r("div",Wt,[(i(),r(h,null,g(5,l=>t("div",{key:l,class:"skeleton-row mb-3"},[...e[44]||(e[44]=[V('<div class="d-flex justify-content-between align-items-center" data-v-1caa55a6><div class="d-flex gap-3 flex-grow-1" data-v-1caa55a6><div class="skeleton" style="width:60px;height:20px;" data-v-1caa55a6></div><div class="skeleton" style="width:150px;height:20px;" data-v-1caa55a6></div><div class="skeleton" style="width:80px;height:20px;" data-v-1caa55a6></div></div><div class="skeleton" style="width:100px;height:30px;" data-v-1caa55a6></div></div>',1)])])),64))])):s.payouts.length?(i(),r("div",Zt,[t("table",$t,[t("thead",es,[t("tr",null,[t("th",ts,[v(t("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":e[8]||(e[8]=l=>s.selectAll=l),onChange:e[9]||(e[9]=(...l)=>n.toggleSelectAll&&n.toggleSelectAll(...l)),disabled:!n.canSelectPayouts},null,40,ss),[[B,s.selectAll]])]),e[47]||(e[47]=t("th",{class:"border-0"},"Batch / Reference",-1)),e[48]||(e[48]=t("th",{class:"border-0"},"Recipient",-1)),e[49]||(e[49]=t("th",{class:"border-0"},"Type",-1)),e[50]||(e[50]=t("th",{class:"border-0 text-end"},"Amount",-1)),e[51]||(e[51]=t("th",{class:"border-0"},"Status",-1)),e[52]||(e[52]=t("th",{class:"border-0"},"Created",-1)),e[53]||(e[53]=t("th",{class:"border-0 text-end"},"Actions",-1))])]),t("tbody",null,[(i(!0),r(h,null,g(s.payouts,l=>(i(),r("tr",{key:l.id,class:m({"table-warning":l.hasBlockers})},[t("td",null,[v(t("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":e[10]||(e[10]=w=>s.selectedPayouts=w),value:l.id,disabled:!n.canSelectPayout(l)},null,8,ls),[[B,s.selectedPayouts]])]),t("td",null,[t("div",ns,o(l.batchId||l.reference),1),l.isBulk?(i(),r("small",as,o(l.recipientCount)+" recipients ",1)):d("",!0)]),t("td",null,[t("div",os,[t("span",{class:m(["recipient-icon me-2",l.recipientType])},[t("i",{class:m(l.recipientType==="beneficiary"?"fa fa-user":"fa fa-building")},null,2)],2),t("div",null,[t("div",null,o(l.recipientName),1),l.hasBlockers?(i(),r("small",is,[e[54]||(e[54]=t("i",{class:"fa fa-exclamation-triangle me-1"},null,-1)),c(" "+o(l.blockerReason),1)])):d("",!0)])])]),t("td",null,[t("span",{class:m(["badge",l.isBulk?"bg-info":"bg-secondary"])},o(l.isBulk?"Bulk":"Single"),3)]),t("td",rs,[t("div",us,"₦"+o(n.formatAmount(l.amount)),1),l.fee?(i(),r("small",ds," + ₦"+o(n.formatAmount(l.fee))+" fee ",1)):d("",!0)]),t("td",null,[x(T,{status:l.status,type:"payout"},null,8,["status"])]),t("td",null,[t("span",{title:n.formatFullDate(l.createdAt)},o(n.formatRelativeTime(l.createdAt)),9,cs)]),t("td",ms,[t("div",fs,[l.status==="queued"||l.status==="pending_approval"?(i(),C(f,{key:0,requires:"payout:execute","user-permissions":s.userPermissions,"user-role":s.userRole},{default:p(()=>[t("button",{class:"btn btn-success btn-sm",onClick:w=>n.openExecuteModal(l),disabled:l.hasBlockers,title:l.hasBlockers?l.blockerReason:"Execute payout"},[...e[55]||(e[55]=[t("i",{class:"fa fa-play"},null,-1)])],8,bs)]),_:2},1032,["user-permissions","user-role"])):d("",!0),l.status==="queued"&&l.requiresApproval?(i(),C(f,{key:1,requires:"payout:approve","user-permissions":s.userPermissions,"user-role":s.userRole},{default:p(()=>[t("button",{class:"btn btn-outline-success btn-sm",onClick:w=>n.approvePayout(l)},[...e[56]||(e[56]=[t("i",{class:"fa fa-check"},null,-1)])],8,ys)]),_:2},1032,["user-permissions","user-role"])):d("",!0),["queued","pending_approval"].includes(l.status)?(i(),C(f,{key:2,requires:"payout:cancel","user-permissions":s.userPermissions,"user-role":s.userRole},{default:p(()=>[t("button",{class:"btn btn-outline-danger btn-sm",onClick:w=>n.cancelPayout(l)},[...e[57]||(e[57]=[t("i",{class:"fa fa-times"},null,-1)])],8,ps)]),_:2},1032,["user-permissions","user-role"])):d("",!0),l.status==="failed"?(i(),C(f,{key:3,requires:"payout:create","user-permissions":s.userPermissions,"user-role":s.userRole},{default:p(()=>[t("button",{class:"btn btn-outline-warning btn-sm",onClick:w=>n.retryPayout(l)},[...e[58]||(e[58]=[t("i",{class:"fa fa-redo"},null,-1)])],8,vs)]),_:2},1032,["user-permissions","user-role"])):d("",!0),l.status==="completed"?(i(),r("button",{key:4,class:"btn btn-outline-secondary btn-sm",onClick:w=>n.viewReceipt(l)},[...e[59]||(e[59]=[t("i",{class:"fa fa-receipt"},null,-1)])],8,hs)):d("",!0),t("button",{class:"btn btn-outline-secondary btn-sm",onClick:w=>n.viewDetails(l)},[...e[60]||(e[60]=[t("i",{class:"fa fa-ellipsis-v"},null,-1)])],8,gs)])])],2))),128))])])])):(i(),r("div",Gt,[e[45]||(e[45]=t("div",{class:"empty-icon mb-3"},[t("i",{class:"fa fa-inbox",style:{"font-size":"3rem",color:"#ccc"}})],-1)),e[46]||(e[46]=t("h5",{class:"text-dark"},"No payouts found",-1)),t("p",Xt,o(s.activeTab==="queue"?"Your payout queue is empty":"No payouts in this category"),1)])),s.selectedPayouts.length>0?(i(),r("div",ks,[t("div",ws,[t("span",null,[t("strong",null,o(s.selectedPayouts.length),1),e[61]||(e[61]=c(" payouts selected ",-1)),t("span",xs,"(₦"+o(n.formatAmount(n.selectedTotalAmount))+")",1)]),t("div",Ps,[x(f,{requires:"payout:execute","user-permissions":s.userPermissions,"user-role":s.userRole},{default:p(()=>[t("button",{class:"btn btn-success btn-sm",onClick:e[11]||(e[11]=(...l)=>n.openBulkExecuteModal&&n.openBulkExecuteModal(...l))},[...e[62]||(e[62]=[t("i",{class:"fa fa-play me-1"},null,-1),c(" Execute Selected ",-1)])])]),_:1},8,["user-permissions","user-role"]),x(f,{requires:"payout:cancel","user-permissions":s.userPermissions,"user-role":s.userRole},{default:p(()=>[t("button",{class:"btn btn-outline-danger btn-sm",onClick:e[12]||(e[12]=(...l)=>n.cancelSelected&&n.cancelSelected(...l))},[...e[63]||(e[63]=[t("i",{class:"fa fa-times me-1"},null,-1),c(" Cancel Selected ",-1)])])]),_:1},8,["user-permissions","user-role"])])])])):d("",!0),n.totalPages>1?(i(),r("div",_s,[t("span",Cs," Showing "+o((s.currentPage-1)*s.pageSize+1)+" - "+o(Math.min(s.currentPage*s.pageSize,s.totalCount))+" of "+o(s.totalCount),1),t("nav",null,[t("ul",As,[t("li",{class:m(["page-item",{disabled:s.currentPage===1}])},[t("a",{class:"page-link",href:"#",onClick:e[13]||(e[13]=A(l=>s.currentPage--,["prevent"]))},[...e[64]||(e[64]=[t("i",{class:"fa fa-chevron-left"},null,-1)])])],2),(i(!0),r(h,null,g(n.visiblePages,l=>(i(),r("li",{key:l,class:m(["page-item",{active:s.currentPage===l}])},[t("a",{class:"page-link",href:"#",onClick:A(w=>s.currentPage=l,["prevent"])},o(l),9,Bs)],2))),128)),t("li",{class:m(["page-item",{disabled:s.currentPage===n.totalPages}])},[t("a",{class:"page-link",href:"#",onClick:e[14]||(e[14]=A(l=>s.currentPage++,["prevent"]))},[...e[65]||(e[65]=[t("i",{class:"fa fa-chevron-right"},null,-1)])])],2)])])])):d("",!0)])]),x(S,{show:s.showSinglePayoutModal,"onUpdate:show":e[26]||(e[26]=l=>s.showSinglePayoutModal=l),"modal-classes":"modal-lg"},{header:p(()=>[...e[66]||(e[66]=[t("h5",{class:"modal-title"},[t("i",{class:"fa fa-paper-plane me-2 text-success"}),c(" Create Single Payout ")],-1)])]),footer:p(()=>[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:e[24]||(e[24]=l=>s.showSinglePayoutModal=!1)}," Cancel "),t("button",{type:"button",class:"btn btn-success",onClick:e[25]||(e[25]=(...l)=>n.createSinglePayout&&n.createSinglePayout(...l)),disabled:s.creatingPayout||!n.canCreatePayout},[s.creatingPayout?(i(),r("i",Hs)):d("",!0),e[83]||(e[83]=c(" Queue Payout ",-1))],8,Os)]),default:p(()=>[t("form",{onSubmit:e[23]||(e[23]=A((...l)=>n.createSinglePayout&&n.createSinglePayout(...l),["prevent"]))},[t("div",Ts,[t("div",Ss,[e[69]||(e[69]=t("label",{class:"form-label"},[c("Recipient Type "),t("span",{class:"text-danger"},"*")],-1)),t("div",Ms,[t("button",{type:"button",class:m(["btn",s.newPayout.recipientType==="beneficiary"?"btn-success":"btn-outline-secondary"]),onClick:e[15]||(e[15]=l=>s.newPayout.recipientType="beneficiary")},[...e[67]||(e[67]=[t("i",{class:"fa fa-user me-1"},null,-1),c(" Beneficiary ",-1)])],2),t("button",{type:"button",class:m(["btn",s.newPayout.recipientType==="vendor"?"btn-success":"btn-outline-secondary"]),onClick:e[16]||(e[16]=l=>s.newPayout.recipientType="vendor")},[...e[68]||(e[68]=[t("i",{class:"fa fa-building me-1"},null,-1),c(" Vendor ",-1)])],2)])]),t("div",Rs,[t("label",Is,[c(o(s.newPayout.recipientType==="beneficiary"?"Beneficiary":"Vendor")+" ",1),e[70]||(e[70]=t("span",{class:"text-danger"},"*",-1))]),v(t("select",{class:"form-select","onUpdate:modelValue":e[17]||(e[17]=l=>s.newPayout.recipientId=l),required:""},[e[71]||(e[71]=t("option",{value:""},"Select recipient...",-1)),(i(!0),r(h,null,g(n.availableRecipients,l=>(i(),r("option",{key:l.id,value:l.id,disabled:l.blocked},[c(o(l.name)+" ",1),l.blocked?(i(),r(h,{key:0},[c("(Blocked: "+o(l.blockReason)+")",1)],64)):d("",!0)],8,qs))),128))],512),[[_,s.newPayout.recipientId]])]),t("div",Es,[e[73]||(e[73]=t("label",{class:"form-label"},"Fundraiser (Source)",-1)),v(t("select",{class:"form-select","onUpdate:modelValue":e[18]||(e[18]=l=>s.newPayout.fundraiserId=l)},[e[72]||(e[72]=t("option",{value:""},"Organization Wallet",-1)),(i(!0),r(h,null,g(s.fundraisers,l=>(i(),r("option",{key:l.id,value:l.id},o(l.title)+" (₦"+o(n.formatAmount(l.availableBalance))+") ",9,Ds))),128))],512),[[_,s.newPayout.fundraiserId]])]),t("div",Us,[e[75]||(e[75]=t("label",{class:"form-label"},[c("Amount "),t("span",{class:"text-danger"},"*")],-1)),t("div",Fs,[e[74]||(e[74]=t("span",{class:"input-group-text"},"₦",-1)),v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[19]||(e[19]=l=>s.newPayout.amount=l),onInput:e[20]||(e[20]=l=>s.newPayout.amount=s.newPayout.amount.replace(/[^\d]/g,"")),required:""},null,544),[[R,s.newPayout.amount]])]),n.estimatedFee?(i(),r("small",Ns," Estimated fee: ₦"+o(n.formatAmount(n.estimatedFee)),1)):d("",!0)]),t("div",Vs,[e[77]||(e[77]=t("label",{class:"form-label"},"Payment Method",-1)),v(t("select",{class:"form-select","onUpdate:modelValue":e[21]||(e[21]=l=>s.newPayout.paymentMethod=l)},[...e[76]||(e[76]=[t("option",{value:"bank_transfer"},"Bank Transfer",-1),t("option",{value:"mobile_money"},"Mobile Money",-1)])],512),[[_,s.newPayout.paymentMethod]])]),t("div",zs,[e[78]||(e[78]=t("label",{class:"form-label"},"Description / Memo",-1)),v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[22]||(e[22]=l=>s.newPayout.description=l),placeholder:"e.g., Medical supplies reimbursement"},null,512),[[R,s.newPayout.description]])])]),s.newPayout.amount?(i(),r("div",Ls,[e[82]||(e[82]=t("h6",{class:"text-dark mb-3"},"Balance Impact",-1)),t("div",Ks,[t("div",Qs,[e[79]||(e[79]=t("div",{class:"text-muted small"},"Current Available",-1)),t("div",js,"₦"+o(n.formatAmount(s.balances.available)),1)]),t("div",Ys,[e[80]||(e[80]=t("div",{class:"text-muted small"},"After Payout",-1)),t("div",{class:m(["fw-bold",n.balanceAfterPayout<0?"text-danger":"text-success"])}," ₦"+o(n.formatAmount(n.balanceAfterPayout)),3)])]),n.balanceAfterPayout<0?(i(),r("div",Js,[...e[81]||(e[81]=[t("i",{class:"fa fa-exclamation-triangle me-1"},null,-1),c(" Insufficient funds for this payout. ",-1)])])):d("",!0)])):d("",!0)],32)]),_:1},8,["show"]),s.showExecuteModal?(i(),C(b,{key:1,show:s.showExecuteModal,"onUpdate:show":e[27]||(e[27]=l=>s.showExecuteModal=l),payout:s.payoutToExecute,balance:s.balances.available,onExecute:n.executePayout,onClose:e[28]||(e[28]=l=>s.showExecuteModal=!1)},null,8,["show","payout","balance","onExecute"])):d("",!0),x(M,{show:s.showCancelConfirm,"onUpdate:show":e[29]||(e[29]=l=>s.showCancelConfirm=l),title:"Cancel Payout",message:`Are you sure you want to cancel this payout to ${(q=s.payoutToCancel)==null?void 0:q.recipientName}?`,"requires-reason":!0,"reason-placeholder":"Reason for cancellation...","confirm-text":"Cancel Payout",type:"warning",processing:s.cancelling,onConfirm:n.confirmCancelPayout},null,8,["show","message","processing","onConfirm"])])}const sl=I(Tt,[["render",Ws],["__scopeId","data-v-1caa55a6"]]);export{sl as default};
