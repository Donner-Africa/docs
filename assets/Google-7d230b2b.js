import{l as d,B as v,o as u,A as f,S as a,U as w,a as g,f as h,m,q as p}from"./index-c49e93e4.js";const _={class:"min-h-screen flex items-center justify-center relative overflow-hidden"},x={__name:"Google",setup(y){const c=v();return u(async()=>{var o;await new Promise(e=>setTimeout(e,300));try{const e=window.location.hash.substring(1),n=new URLSearchParams(e).get("id_token");if(!n)throw new Error("No ID token received from Google");let r=null;try{const i=await fetch("https://ipapi.co/json/");if(i.ok){const s=await i.json();r=`${s.city}, ${s.region}, ${s.country}`}}catch{}const l={provider:"google",accessToken:n,location:r},{data:t}=await f.createSession(l);if(((o=t.verification)==null?void 0:o.status)!=="VERIFIED"){await a.IndexedDB.set("DonnerDB","UserStore","verification",t.verification),c.push({name:"Verification"});return}t!=null&&t.deviceToken?(await a.IndexedDB.set("DonnerDB","UserStore","authorization",{token:t.deviceToken}),a.LocalStorage.set("DA_IS_AUTHORITY",!0),await a.IndexedDB.delete("DonnerDB","UserStore","preAuthorization"),t.user&&w.set("user",{...t.user}),window.location.href="/"):(console.error("No deviceToken in session response"),window.location.href="/account/login?error=session")}catch(e){console.error("Google sign-in failed",e),window.location.href="/account/login?error=google"}}),(o,e)=>(g(),h("div",_,[...e[0]||(e[0]=[m('<div class="absolute inset-0 bg-slate-950/10 animate-fade-in" data-v-e712559a></div><div class="container mx-auto px-4 relative z-10" data-v-e712559a><div class="max-w-lg mx-auto" data-v-e712559a><div class="bg-white shadow-xl rounded-2xl p-5 flex flex-col items-center text-center animate-slide-up" data-v-e712559a><div class="w-24 h-24 rounded-full bg-white shadow ring-1 ring-slate-200 flex items-center justify-center mb-6" data-v-e712559a><img src="'+p+'" class="w-16 h-16" alt="App Icon" data-v-e712559a></div><h2 class="text-2xl font-semibold mb-2" data-v-e712559a>Signing you in with Google</h2><p class="text-gray-600 mb-6" data-v-e712559a> Please wait while we authenticate you with Google. </p><div class="flex justify-center" data-v-e712559a><div class="loader" data-v-e712559a></div></div></div></div></div>',2)])]))}},k=d(x,[["__scopeId","data-v-e712559a"]]);export{k as default};
