import{l as C,R as S,V as R,p as U,r as m,a as c,f as g,b as s,t as l,c as v,w as d,v as z,x as D,d as p,n as x,s as y,e as i}from"./index-5e43ba67.js";import{B as L}from"./BaseButton-0ea92229.js";import{M as F}from"./Modal-54d3ef08.js";import{D as M}from"./AdvancedTable-433f4ae3.js";import{C as B}from"./ComplianceService-5a46b622.js";import{P as h}from"./PaymentService-dc6f52ed.js";import{f as _}from"./FormUtility-a2bc7d0b.js";const N={components:{BaseButton:L,Fire:S,Modal:F,TransfersTable:M},data(){return{currentStep:0,complianceLoading:!0,verificationScore:0,loading:{raiser:!0,transfers:!0},raiser:{},user:{},apiUrl:"/me/transfers",searchQuery:"",columns:[{label:"Beneficiary",key:"beneficiaryName",sort:!1},{label:"Amount",key:"amount",formatter:o=>`₦${_(o)}`},{label:"Raiser",key:"raiserTitle",sort:!1},{label:"Status",key:"status"},{label:"Date",key:"date"}],transfers:[],transferCount:0,selectedTransfer:{},showTransferModal:!1}},created(){const o=R();this.user=o.$state,this.loadUserCompliane(),this.searchTransfers()},watch:{},computed:{},methods:{formatAmount:_,async searchTransfers(o){const{sort:e,direction:u,page:f=0,size:t=50,search:n}=o||{};try{const a={page:f,size:t,sort:e,direction:u,search:n||this.searchQuery};return await h.getTransfers(a)}catch(a){U().toast({message:a.message||"Your transfer information could not be loaded<br>Please reload the page",type:"error",duration:5e3})}},async loadUserCompliane(){this.complianceLoading=!0;try{const{data:o}=await B.fetchUserComplianceData("NG");this.verificationScore=(o==null?void 0:o.score)||0}catch(o){console.error("Failed to load compliance data:",o),this.verificationScore=0}finally{this.complianceLoading=!1}},showTransfer(o){this.selectedTransfer=o,this.showTransferModal=!0},async downloadReceipt(o){h.downloadReceipt(o)},reportTransfer(o){const e=`Donner - Transfer Reporting - Reference: ${o}`,u=`Hello,

Please find the details of the transfer below:

Reference: ${o}

Best regards,
${this.user.name}`,f=`mailto:report@donner.africa?subject=${encodeURIComponent(e)}&body=${encodeURIComponent(u)}`;window.location.href=f}}},A={class:""},I={class:"container-fluid"},Q={class:"row mb-3"},E={class:"col-sm-12 order-2 order-sm-0 text-start pt-3"},P={class:"text-foreground",style:{"font-size":"30px"}},V={class:"row px-md-2 py-4"},j={class:"col-lg-4 px-0 px-lg-4 order-lg-2"},q={class:"card position-sticky shadow-none h-[100%] border border-light",style:{top:"100px",height:"fit-content !important"}},Y={class:"card-body p-3 py-3"},G={class:"d-flex rounded-3 p-3 position-relative ps-1"},H={key:2,class:"btn btn-outline-secondary mb-0 ms-auto z-index-3 px-3",disabled:""},K={class:"col-lg-8 backdrop-blur-md rounded-3 border border-light order-lg-1 mt-4 mt-lg-0"},W={class:"page-header min-vh-25 bg-muted/50 overflow-none",style:{border:"solid transparent 2px","border-width":"0 2px 2px 2px","border-radius":"0 0 0.5rem 0.5rem"}},J={class:"container"},O={class:"row"},X={class:"col-11 text-start mx-auto mb-0 py-5"},Z={class:"row w-[100%]"},$={class:"col-12"},ss={class:"input-group"},es=["onClick"],ts=["onClick"],os={key:0},rs={class:"card bg-background/95 p-3 modal-fade-in shadow-xs rounded-3"},ns={class:"card-body position-relative mx-1 rounded-3 row backdrop-blur-md border border-light mb-0 rounded-3"},ls={class:"col-lg-12 py-5 text-foreground px-2 px-sm-5 text-start position-relative no-scrollbar",style:{overflow:"hidden","overflow-y":"scroll",height:"400px"}},as={class:"mx-3 mx-md-0"},is={class:"row"},ds={class:"col-3 position-relative mt-2",style:{scale:"0.2"}},cs={class:"row mb-3 pt-3 text-lg"},us={class:"col-12 mb-3"},fs={class:"col-12 mb-3"},ms={class:"col-12 mb-3"},ps={class:"col-12 mb-3"},bs={class:"col-12 mb-3"},gs={class:"col-12 mb-3"},xs={class:"col-6 mb-2"},vs={class:"card-footer mt-0 px-3 row"},ys={class:"backdrop-blur-md px-4 py-3 col-12 rounded-3"},hs={class:"row"},_s={class:"col-12 text-end"};function ws(o,e,u,f,t,n){const a=m("RouterLink"),b=m("TransfersTable"),w=m("Fire"),T=m("Modal");return c(),g("div",null,[s("section",A,[s("div",I,[s("div",Q,[s("div",E,[s("h1",P," Welcome "+l(t.user.firstName),1)])]),s("div",V,[s("div",j,[s("div",q,[e[11]||(e[11]=s("div",{class:"card-header p-0 p-lg-3 pb-0"},[s("div",{class:"row"},[s("div",{class:"col-8 d-flex"},[s("div",{class:"d-flex flex-column justify-content-center"})])])],-1)),s("div",Y,[s("div",G,[e[9]||(e[9]=s("div",{class:"mask opacity-10 z-index-0 rounded-3 bg-muted border border-success"},null,-1)),e[10]||(e[10]=s("h5",{class:"my-auto text-foreground z-index-3 ps-2"}," Start Transfer ",-1)),t.verificationScore>=4?(c(),v(a,{key:0,to:"/me/transfers/start",class:"btn btn-success mb-0 ms-auto z-index-3 px-3"},{default:d(()=>[...e[6]||(e[6]=[s("i",{class:"fa fa-paper-plane"},null,-1)])]),_:1})):t.complianceLoading?(c(),g("button",H,[...e[8]||(e[8]=[s("i",{class:"fa fa-spinner fa-spin"},null,-1)])])):(c(),v(a,{key:1,to:"/me/kyc",class:"btn btn-outline-secondary mb-0 ms-auto z-index-3 px-3",title:"Complete KYC to unlock transfers"},{default:d(()=>[...e[7]||(e[7]=[s("i",{class:"fa fa-lock"},null,-1)])]),_:1}))])])])]),s("div",K,[s("div",W,[e[14]||(e[14]=s("div",{class:"mask blur-sm",style:{"background-image":"url('/img/shapes/waves-green.png')",opacity:"0.05 !important"}},null,-1)),e[15]||(e[15]=s("div",{class:"mask bg-muted/30 opacity-3"},null,-1)),s("div",J,[s("div",O,[s("div",X,[e[13]||(e[13]=s("h3",{class:"text-foreground mb-3"}," Recent Transfers ",-1)),s("form",Z,[s("div",$,[s("div",ss,[e[12]||(e[12]=s("span",{class:"input-group-text"},[s("i",{class:"text-foreground px-2 fa fa-search"})],-1)),z(s("input",{required:"",type:"text",class:"form-control text-secondary","onUpdate:modelValue":e[0]||(e[0]=r=>t.searchQuery=r),placeholder:"Find by raiser or beneficiary"},null,512),[[D,t.searchQuery]])])])])])])])]),p(b,{hasActions:!1,loadAsync:!0,title:"transfers",selectedRow:t.selectedTransfer,"onUpdate:selectedRow":[e[1]||(e[1]=r=>t.selectedTransfer=r),n.showTransfer],apiUrl:"/me/transfers",fetchData:n.searchTransfers,filterQuery:o.debouncedSearchQuery,columns:t.columns},{status:d(({row:r})=>[s("span",{class:x(["badge badge-sm",r.status=="SUCCESSFUL"?"bg-success":r.status=="FAILED"?"bg-danger":"bg-warning"])},l(r.status),3)]),actions:d(({row:r})=>[s("button",{class:"btn btn-outline-success border-light btn-sm rounded-2 text-sm px-2 me-3",onClick:y(k=>n.showTransfer(r),["stop"])}," View ",8,es),s("button",{class:"btn btn-white text-success btn-handleClicksm px-1 rounded-1 border border-light border-success text-center",title:"Print Receipt",onClick:y(k=>n.downloadReceipt(r.reference),["stop"])},[...e[16]||(e[16]=[s("i",{class:"fa fa-receipt",style:{"font-size":"16px"}},null,-1)])],8,ts)]),_:1},8,["selectedRow","fetchData","filterQuery","columns","onUpdate:selectedRow"])])])])]),(c(),g("div",os,[p(T,{show:t.showTransferModal,"onUpdate:show":e[5]||(e[5]=r=>t.showTransferModal=r),"body-classes":"p-0","modal-classes":"modal-lg"},{default:d(()=>[s("div",rs,[s("button",{onClick:e[2]||(e[2]=r=>t.showTransferModal=!1),class:"position-absolute end-0 me-4 mt-1 btn btn-sm backdrop-blur-md bg-secondary rounded-3 rounded-3 px-2 py-1",style:{"z-index":"1000000"}},[...e[17]||(e[17]=[s("i",{class:"fa fa-times text-white",style:{"font-size":"15px"}},null,-1)])]),s("div",ns,[s("div",ls,[s("div",as,[s("div",is,[e[18]||(e[18]=s("div",{class:"col-9"},[s("h4",{class:"text-start text-foreground pb-2"},"Transfer Summary")],-1)),s("div",ds,[s("div",{class:x(["w-[100%] position-absolute ms-n8 pt-10",t.selectedTransfer.status=="SUCCESSFUL"?"":"d-none"])},[p(w)],2)])]),e[25]||(e[25]=s("hr",{class:"horizontal dark"},null,-1)),s("div",cs,[s("div",us,[e[19]||(e[19]=s("strong",null,"From:",-1)),i(" "+l(t.selectedTransfer.raiserTitle),1)]),s("div",fs,[e[20]||(e[20]=s("strong",null," To: ",-1)),i(" "+l(t.selectedTransfer.beneficiaryName),1)]),s("div",ms,[e[21]||(e[21]=s("strong",null,"Date:",-1)),i(" "+l(t.selectedTransfer.formattedDate),1)]),s("div",ps,[e[22]||(e[22]=s("strong",null,"Amount:",-1)),i(" ₦"+l(n.formatAmount(t.selectedTransfer.amount)),1)]),s("div",bs,[e[23]||(e[23]=s("strong",null,"Reference:",-1)),i(" "+l(t.selectedTransfer.reference),1)]),s("div",gs,[s("span",{class:x(["badge px-2 badge-sm text-xs",t.selectedTransfer.status=="SUCCESSFUL"?"bg-success":t.selectedTransfer.status=="SUCCESSFUL"?"bg-error":"bg-gradient-dark"])},l(t.selectedTransfer.status),3)]),s("div",xs,[s("button",{class:"btn btn-link px-0 text-foreground",onClick:e[3]||(e[3]=r=>n.reportTransfer(t.selectedTransfer.reference))},[...e[24]||(e[24]=[s("i",{class:"fa fa-flag me-2"},null,-1),i(" Report Issue ",-1)])])])]),e[26]||(e[26]=s("hr",null,null,-1))])])]),s("div",vs,[s("div",ys,[s("div",hs,[s("div",_s,[p(a,{to:"/me/transfers/start",class:"btn btn-success mb-0 mx-3"},{default:d(()=>[...e[27]||(e[27]=[i(" Repeat ",-1)])]),_:1}),s("button",{onClick:e[4]||(e[4]=r=>n.downloadReceipt(t.selectedTransfer.reference)),class:"btn btn-outline-success backdrop-blur-md mb-0"}," Print Receipt ")])])])])])]),_:1},8,["show"])]))])}const Ds=C(N,[["render",ws],["__scopeId","data-v-668f25d4"]]);export{Ds as default};
