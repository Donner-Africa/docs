import"./Delta-c6979714.js";import{l as I,U as M,p as m,r as b,a,f as l,b as t,q as S,e as d,h as g,t as h,F as B,g as L,P as U,d as p,w as c,s as F,v as D,x as E}from"./index-3ad8e48a.js";/* empty css                         */import{R as N,S as x,I as T}from"./ImageUploadService-60310f2d.js";import{B as z}from"./BaseButton-50768e86.js";import{B as V}from"./BaseFooter-353ee2c8.js";import{B as P}from"./BaseNav-abd8fd5f.js";import{C as H}from"./ChipContainer-25dce00f.js";import{F as j}from"./FormMessage-bab230ad.js";import{M as A}from"./Modal-5578b24f.js";import{S as G}from"./SDGSelect-1560c884.js";import{C as k}from"./ConfigurationService-9573c308.js";import{F as f}from"./FundRaiserService-ecbb5b21.js";import"./NavigationStore-1967079d.js";import{f as Y}from"./FormUtility-a2bc7d0b.js";import"./logo-f32e4fd3.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-203f5787.js";import"./ohash.D__AXeF1-7a03e119.js";const q={components:{BaseButton:z,BaseFooter:V,BaseNav:P,ChipContainer:H,FormMessage:j,Modal:A,SDGSelect:G,VuePictureCropper:N},data(){return{croppingImage:!1,croppedImage:"",edit:"none",fundRaiser:{},beneficiary:{name:"",bankCode:"",accountName:"",accountNumber:"",currentStep:1,countryCode:"+234",saved:!1},loading:!1,response:{},photoUrl:"",picture:"",banks:[],savingImage:!1,showImageCropper:!1,showBeneficiaryModal:!1,showBannerModal:!1,showModal:!1,startingRaiser:!1,switchingRaiserType:!1,user:null,sdgs:k.get("sdgs"),sdgColors:k.get("sdgColors")}},async beforeMount(){if(!await M.get("isLoggedIn"))return this.$router.push("/account/login");const e=this.$route.params.urlPath;try{const n=await f.get("fundRaiser",e);if(!n)throw new Error("Unable to fetch raiser");this.fundRaiser=n,this.photoUrl=n.bannerImage}catch{m().toast({message:"There was an error loading your fundraiser.<br>Try finding and editing it."}),this.$router.push("/me/raisers")}},mounted(){},computed:{categoryNames(){return this.categories.map(r=>r.name)},subCategoryNames(){const r=this.categories.find(e=>e.name===this.fundRaiser.category);return r?r.subCategories:[]}},methods:{formatAmount:Y,openImageSelectionDialog(){this.$refs.imageFileUploadInput.click()},async openImageCropper(r){const e=m();this.picture=!1,this.croppedImage="";const n=r.target.files[0],u=new FileReader;u.onload=()=>{this.picture=String(u.result),this.showImageCropper=!0,r.target.value=""};try{await u.readAsDataURL(n)}catch(s){e.toast({message:s.message||"An error was encountered while loading the image.",type:"error",duration:5e3})}},async cropImage(){const r=m();if(x){this.croppingImage=!0;try{const e=await x.getFile(),n=await T.uploadBannerImage(e);this.photoUrl=n.secure_url,this.showImageCropper=!1}catch(e){r.toast({message:e.message||"Cropping the image failed",type:"error",duration:5e3})}this.croppingImage=!1}},async saveCroppedImage(){this.savingImage=!0;const r=m();try{const e={image:`${this.photoUrl}`},{data:n}=await f.updateSectionData(this.fundRaiser.reference,"BANNER_INFORMATION",e);this.fundRaiser.bannerImage=n.bannerImage}catch(e){r.toast({message:e.message||"We could not save the image.<br/>Check your network and try again.",type:"error",duration:5e3})}this.savingImage=!1},closeBannerModal(){this.showBannerModal=!1,this.picture="",this.showImageCropper=!1,this.photoUrl=this.fundRaiser.bannerImage},async updateFundRaiser(){this.loading=!0;const r=m(),e={};e[this.edit]=this.fundRaiser[this.edit];try{const{data:n,meta:u}=await f.updateFundRaiser(this.fundRaiser.reference,e);r.toast({message:"Done",type:"success",duration:5e3}),this.fundRaiser=n,setTimeout(()=>{this.showModal=!1},2e3)}catch(n){r.toast({message:n.message||"Failed",type:"error",duration:5e3})}this.loading=!1},async startRaising(){const r=m();this.startingRaiser=!0;try{const{data:e,meta:n}=await f.updateFundRaiser(this.fundRaiser.reference,{status:"PUBLISHED"});this.$router.push(`/raisers/${e.urlPath}`)}catch{r.toast({message:"There was an error while publishing your fundraiser.",type:"error",duration:5e3});return}this.startingRaiser=!1}}},O={class:"position"},K={class:"page-header min-vh-100",style:{"align-items":"start",background:"#EDF9E833"}},W={class:"ps-0 pe-0 w-[100%] my-0 mb-1 p-0"},X={class:"row"},J={class:"col-lg-12 d-flex justify-content-center flex-column my-0"},Q={id:"reviewPane",class:"card card-body backdrop-blur-md d-flex justify-content-top px-ms-5 shadow-lg mt-0 pt-5 pb-4 min-vh-100 rounded-3 position-relative",style:{}},Z={class:"h-[100%] position-relative",style:{display:"contents"}},$={class:"row"},ee={class:"col-lg-7 col-md-10 col-sm-12 px-md-5 px-sm-0 px-4 pt-6 ms-auto me-auto"},te={class:"row position-relative"},se={class:"col-12"},oe={class:"position-relative w-[100%] rounded-3 bg-gradient-light text-center align-items-center",style:{height:"400px",cursor:"pointer","aspect-ratio":"16 / 9"}},re=["src"],ne={class:"d-none",type:"file",accept:"image/*",ref:"imageFileUploadInput"},ie={class:"col-12 mt-5 px-5"},ae={class:"row mb-5 ps-1 border border-light rounded-3 border-secondary"},le={class:"col-10 pt-1"},de={class:"mt-1 text-gradient text-dark"},pe={class:"col-2"},ce={class:"row mb-5 ps-1 border border-light rounded-3 border-secondary"},ue={class:"col-10 pt-1"},me={key:0,class:"mt-1 text-gradient text-dark"},ge={key:1,class:"mt-1 text-gradient text-dark"},be={class:"row mb-5 ps-1 border border-light rounded-3 border-secondary"},he={class:"col-10 pt-1"},fe={class:"mt-1 text-gradient text-dark"},we={key:0,class:"fa fa-arrow-right px-3",style:{"font-size":"11px"}},ye={class:"row mb-5 ps-1 border border-light rounded-3 border-secondary"},ve={class:"col-10 pt-1"},xe={key:0,class:"my-2"},ke={key:1,class:"my-2"},_e={class:"row mb-5 ps-1 border border-light rounded-3 border-secondary"},Ce={class:"col-10 pt-1"},Re=["innerHTML"],Ie={class:"w-[100%] pt-1 py-3 backdrop-blur-md",style:{bottom:"0"}},Me={class:"pt-3 row"},Se={class:"text-end col-12 pe-6 pe-sm-9 pe-md-8"},Be={class:"card bg-white/95 p-3 rounded-3"},Le={class:"mx-1 rounded-3 row backdrop-blur-md",style:{overflow:"hidden"}},Ue={class:"col-12"},Fe={class:"my-4 p-4"},De={class:"row px-0 px-sm-4"},Ee={class:"col-12"},Ne={class:"row"},Te={class:"form-group mb-4"},ze={class:"card bg-transparent shadow-xs p-3 rounded-3"},Ve={class:"mx-1 rounded-3 row backdrop-blur-md blur-light",style:{background:"#ffffffac !important"}},Pe={class:"col-lg-12 pb-0 pt-4 text-white px-4",style:{"min-height":"300px"}},He={class:""},je={class:"row"},Ae={key:0,class:"col-12"},Ge=["src"],Ye={class:"rounded-3 border backdrop-blur-md blur-darker opacity-10 d-inline-block p-3 mt-7 text-white border-white text-lg"},qe={key:0},Oe=["disabled"],Ke={key:1,class:"col-12"},We={class:"backdrop-blur-md blur-light rounded-3 h-[100%] border-bottom-end-radius-0"},Xe={class:"form-group no-scrollbar",style:{height:"300px","overflow-y":"scroll"}};function Je(r,e,n,u,s,i){const _=b("RouterLink"),w=b("BaseButton"),y=b("base-button"),v=b("modal"),C=b("VuePictureCropper");return a(),l("div",null,[t("div",O,[e[30]||(e[30]=t("div",{class:"position-absolute top-0 start-0 d-none d-md-flex",style:{"z-index":"200"}},[t("a",{href:"/",class:"d-none d-md-inline-block icon icon-shape icon-lg rounded-circle bg-white shadow text-center p-2 m-2"},[t("img",{src:S,class:"w-[80%] h-[80%] mt-1"})])],-1)),t("div",K,[t("div",W,[t("div",X,[t("div",J,[t("div",Q,[t("div",Z,[e[26]||(e[26]=t("h1",{class:"text-gradient text-dark mb-0 mt-8 mt-sm-0 ms-auto me-auto text-sm-center"}," Your fundraiser is almost ready.",-1)),e[27]||(e[27]=t("h5",{class:"mb-2 text-gradient text-dark ms-auto me-auto text-sm-center"},[d("You are one click away from a timeless legacy. "),t("span",{class:"gradient-animation text-gradient"},"ðŸ€")],-1)),t("div",$,[t("div",ee,[t("div",te,[t("div",se,[t("div",oe,[t("img",{src:s.fundRaiser.bannerImage||"/img/backgrounds/banner.placeholder.png",style:{"object-fit":"cover",left:"0"},class:"rounded-3 w-[100%] h-[100%] position-absolute"},null,8,re),s.fundRaiser.bannerImage?g("",!0):(a(),l("span",{key:0,onClick:e[0]||(e[0]=o=>{s.showBannerModal=!0,i.openImageSelectionDialog()}),class:"rounded-3 border bg-light opacity-8 d-inline-block p-3 mt-8 border-white text-lg"},[...e[13]||(e[13]=[d(" Click here to upload a picture. ",-1),t("br",null,null,-1),t("span",{class:"text-sm"}," It will be worth a thousand words.",-1)])])),t("div",{onClick:e[1]||(e[1]=o=>{s.showBannerModal=!0,i.openImageSelectionDialog()}),class:"position-absolute top-0 end-0 px-3"},[...e[14]||(e[14]=[t("button",{class:"mt-2 btn btn-sm rounded-circle border-0 btn-outline-dark bg-gradient-dark btn-outline-dark bg-gradient-dark text-dark px-0 text-center float-end",style:{width:"35px !important",height:"35px !important"}},[t("i",{class:"fa fa-pen text-white",style:{"font-size":"12px"}})],-1)])]),t("input",ne,null,512)])]),t("div",ie,[t("div",ae,[t("div",le,[e[15]||(e[15]=t("b",{class:"mb-0 text-dark"},"Title",-1)),e[16]||(e[16]=t("hr",{class:"w-80 border m-0 p-0 border-light border-secondary"},null,-1)),t("h5",de,h(s.fundRaiser.title),1)]),t("div",pe,[t("button",{class:"mt-2 btn btn-sm rounded-circle border-0 btn-outline-dark bg-gradient-dark btn-outline-dark bg-gradient-dark text-dark px-0 text-center float-end",style:{width:"35px !important",height:"35px !important"},onClick:e[2]||(e[2]=o=>{s.edit="title",s.showModal=!0})},[...e[17]||(e[17]=[t("i",{class:"fa fa-pen text-white",style:{"font-size":"12px"}},null,-1)])])])]),t("div",ce,[t("div",ue,[e[18]||(e[18]=t("b",{class:"mb-0 text-dark"},"Goal",-1)),e[19]||(e[19]=t("hr",{class:"w-80 border m-0 p-0 border-light border-secondary"},null,-1)),s.fundRaiser.goal>100?(a(),l("h6",me," â‚¦ "+h(i.formatAmount(s.fundRaiser.goal)),1)):(a(),l("h6",ge," No goal set "))])]),t("div",be,[t("div",he,[e[20]||(e[20]=t("b",{class:"mb-0 text-dark"},"Category",-1)),e[21]||(e[21]=t("hr",{class:"w-80 border m-0 p-0 border-light border-secondary"},null,-1)),t("h6",fe,[d(h(s.fundRaiser.category)+" ",1),s.fundRaiser.subCategory?(a(),l("i",we)):g("",!0),d(" "+h(s.fundRaiser.subCategory),1)])])]),t("div",ye,[t("div",ve,[e[22]||(e[22]=t("b",{class:"mb-0 text-dark"},"Sustainable Development Goals",-1)),e[23]||(e[23]=t("hr",{class:"w-80 border m-0 p-0 border-light border-secondary"},null,-1)),s.fundRaiser.sdgs&&s.fundRaiser.sdgs.length>0?(a(),l("div",xe,[(a(!0),l(B,null,L(s.fundRaiser.sdgs,(o,R)=>(a(),l("span",{key:R,class:"badge me-1 mb-1",style:U({backgroundColor:"#"+s.sdgColors[o]})},h(s.sdgs[o-1]),5))),128))])):(a(),l("h6",ke," None "))])]),t("div",_e,[t("div",Ce,[e[24]||(e[24]=t("b",{class:"mb-0 text-dark"},"Story",-1)),e[25]||(e[25]=t("hr",{class:"w-80 border m-0 p-0 border-light border-secondary"},null,-1)),t("div",{id:"storyReviewBoard",class:"my-2 p-2 text-dark text-lg text-bold bg-transparent",style:{background:"#fff4"},innerHTML:s.fundRaiser.story},null,8,Re)])])])])])])])])])])])]),t("div",Ie,[t("div",Me,[t("div",Se,[p(_,{to:`/me/raisers/${s.fundRaiser.reference}#general-settings`,class:"btn btn-outline-success bg-white mx-4 d-inline"},{default:c(()=>[...e[28]||(e[28]=[d(" Edit Draft ",-1)])]),_:1},8,["to"]),p(w,{onClick:i.startRaising,class:"mb-0",loading:s.startingRaiser},{default:c(()=>[...e[29]||(e[29]=[d(" Start Raising ",-1)])]),_:1},8,["onClick","loading"])])])])]),p(v,{show:s.showModal,"onUpdate:show":e[6]||(e[6]=o=>s.showModal=o),"body-classes":"p-0","modal-classes":"modal-lg"},{default:c(()=>[t("div",Be,[t("button",{onClick:e[3]||(e[3]=o=>s.showModal=!1),class:"position-absolute end-0 me-4 mt-1 btn btn-sm z-index-3 text-dark backdrop-blur-md bg-secondary border-0 px-2 py-1 rounded-3"},[...e[31]||(e[31]=[t("i",{class:"fa fa-times text-white",style:{"font-size":"15px"}},null,-1)])]),t("div",Le,[t("div",Ue,[t("div",Fe,[e[33]||(e[33]=t("div",{class:"w-[100%] h-25 px-0 px-sm-4 text-start"},[t("div",null,[t("h4",{class:"text-dark pt-4 pb-3 pb-sm-5"}," Change Your Fundraiser's Title ")])],-1)),t("div",De,[t("div",Ee,[t("div",Ne,[s.edit==="title"?(a(),l("form",{key:0,onSubmit:e[5]||(e[5]=F((...o)=>i.updateFundRaiser&&i.updateFundRaiser(...o),["prevent"])),class:"col-12"},[t("div",Te,[D(t("input",{required:"",class:"text-lg form-control form-control-alternative",placeholder:"Title can not be blank","onUpdate:modelValue":e[4]||(e[4]=o=>s.fundRaiser.title=o)},null,512),[[E,s.fundRaiser.title]])]),p(y,{loading:s.loading,nativeType:"submit",type:"primary",class:"btn-success float-end"},{default:c(()=>[...e[32]||(e[32]=[d("Save",-1)])]),_:1},8,["loading"])],32)):g("",!0)])])])])])])])]),_:1},8,["show"]),p(v,{show:s.showBannerModal,"onUpdate:show":e[12]||(e[12]=o=>s.showBannerModal=o),"body-classes":"p-0","modal-classes":"modal-lg"},{default:c(()=>[t("div",ze,[t("button",{onClick:e[7]||(e[7]=o=>i.closeBannerModal()),class:"position-absolute end-0 me-4 mt-1 btn btn-sm z-index-3 text-primary backdrop-blur-md bg-secondary px-2 py-1 rounded-3"},[...e[34]||(e[34]=[t("i",{class:"fa fa-times text-white",style:{"font-size":"15px"}},null,-1)])]),t("div",Ve,[t("div",Pe,[t("div",He,[t("div",je,[e[41]||(e[41]=t("div",{class:"mb-4 text-center w-[100%]"},[t("span",{class:"text-gradient text-dark",style:{"font-size":"20px","font-weight":"700"}},"The Fundraiser's Banner")],-1)),s.showImageCropper?g("",!0):(a(),l("div",Ae,[t("div",{onClick:e[9]||(e[9]=(...o)=>i.openImageSelectionDialog&&i.openImageSelectionDialog(...o)),class:"position-relative w-[100%] rounded-3 bg-white text-center align-items-center mb-3",style:{height:"300px",cursor:"pointer"}},[t("img",{src:s.photoUrl||"/img/backgrounds/banner.placeholder.png",style:{"object-fit":"contain",left:"0"},class:"rounded-3 w-[100%] h-[100%] position-absolute"},null,8,Ge),t("span",Ye,[e[35]||(e[35]=t("i",{class:"fa fa-2x fa-camera"},null,-1)),e[36]||(e[36]=t("br",null,null,-1)),e[37]||(e[37]=d(" Click to change ",-1)),s.photoUrl==""||s.photoUrl==s.fundRaiser.bannerImage?(a(),l("span",qe," your banner")):g("",!0)]),t("input",{onChange:e[8]||(e[8]=(...o)=>i.openImageCropper&&i.openImageCropper(...o)),class:"d-none",type:"file",accept:"image/*",ref:"imageFileUploadInput"},null,544)]),t("button",{type:"button",onClick:e[10]||(e[10]=o=>s.photoUrl=""),disabled:s.photoUrl==""?!0:void 0,class:"btn btn-outline-success bg-white btn-sm float-start position-sticky bottom-0 mx-1 px-2"},[...e[38]||(e[38]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M6 18L12 12L18 18M18 6L11.9989 12L6 6",stroke:"#7E7E7E","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),d(" Remove ",-1)])],8,Oe)])),s.showImageCropper?(a(),l("div",Ke,[t("div",We,[t("div",Xe,[p(C,{boxStyle:{width:"100%",height:"300px",backgroundColor:"#f8f8f8",margin:"0","border-radius":"8px","overflow-y":"clip","overflow-x":"clip"},img:s.picture,options:{viewMode:2,dragMode:"crop",aspectRatio:16/9}},null,8,["img"])]),t("button",{type:"button",onClick:e[11]||(e[11]=o=>{s.photoUrl="",s.showImageCropper=!1}),class:"btn btn-outline-success bg-white btn-sm float-start position-sticky bottom-0 mx-3 px-3"},[...e[39]||(e[39]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M6 18L12 12L18 18M18 6L11.9989 12L6 6",stroke:"#7E7E7E","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),d(" Cancel ",-1)])]),p(y,{type:"button",onClick:i.cropImage,size:"sm",loading:s.croppingImage,class:"btn btn-outline-success bg-white btn-sm float-end position-sticky bottom-0 mx-3 px-3"},{default:c(()=>[...e[40]||(e[40]=[t("svg",{fill:"#7E7E7E",height:"24",width:"24",version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 330 330"},[t("path",{id:"XMLID_28_",d:`M315,240h-45V81.213l55.606-55.606c5.858-5.858,5.858-15.355,0-21.213c-5.857-5.858-15.355-5.858-21.213,0
                                                  L248.787,60H90V15c0-8.284-6.716-15-15-15c-8.284,0-15,6.716-15,15v45H15C6.716,60,0,66.716,0,75s6.716,15,15,15h45v158.787
                                                  L4.394,304.394c-5.858,5.858-5.858,15.355,0,21.213C7.322,328.536,11.161,330,15,330c3.839,0,7.678-1.464,10.606-4.394L81.213,270
                                                  H240v45c0,8.284,6.716,15,15,15c8.284,0,15-6.716,15-15v-45h45c8.284,0,15-6.716,15-15S323.284,240,315,240z M90,90h128.787
                                                  L90,218.787V90z M240,111.213V240H111.213L240,111.213z`})],-1),d(" Crop ",-1)])]),_:1},8,["onClick","loading"])])])):g("",!0)]),p(w,{class:"float-end btn-success mb-4 mt-3",loading:s.savingImage,disabled:s.photoUrl==s.fundRaiser.bannerImage,onClick:i.saveCroppedImage},{default:c(()=>[...e[42]||(e[42]=[d(" Keep ",-1)])]),_:1},8,["loading","disabled","onClick"])])])])])]),_:1},8,["show"])])}const bt=I(q,[["render",Je]]);export{bt as default};
