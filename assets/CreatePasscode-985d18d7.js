import{B as g,D as h,a as l,c as y,w as _,b as e,z as w,q as k,s as p,v as m,f as c,t as P,h as C,j as n,A as f}from"./index-7ab8b32e.js";import{_ as B}from"./PublicLayout-5ccc5a06.js";import"./logo-f32e4fd3.js";import"./NavigationStore-5ae23ca1.js";import"./StarryBackground-a80d183f.js";const V={class:"min-h-screen flex items-center justify-center relative overflow-hidden bg-background"},D={class:"container mx-auto px-4 relative z-10"},S={class:"max-w-md mx-auto"},A={class:"bg-card shadow-xl rounded-2xl p-8 md:p-10"},$=["disabled"],j=["disabled"],q={key:0,class:"text-red-500 text-sm text-center"},z=["disabled"],F={key:0},M={key:1},N={class:"mt-4 text-center"},U=["disabled"],J={__name:"CreatePasscode",setup(E){const i=g(),a=n(""),r=n(""),t=n(!1),o=n(""),v=h(()=>a.value.length===4&&r.value.length===4&&/^\d{4}$/.test(a.value));async function b(){if(o.value="",a.value!==r.value){o.value="Passcodes do not match";return}if(!/^\d{4}$/.test(a.value)){o.value="Passcode must be exactly 4 digits";return}t.value=!0;try{await f.updatePasscode({passcode:a.value,password:""}),i.push("/me/dashboard")}catch(d){o.value=d.message||"Failed to create passcode. Please try again."}finally{t.value=!1}}async function x(){t.value=!0;try{await f.skipPrompt("passcode"),i.push("/me/dashboard")}catch(d){console.error("Failed to skip passcode prompt",d),i.push("/me/dashboard")}finally{t.value=!1}}return(d,s)=>(l(),y(B,null,{default:_(()=>[e("div",V,[e("div",D,[e("div",S,[e("div",A,[s[4]||(s[4]=e("div",{class:"text-center mb-6"},[e("a",{href:"/",class:"inline-block w-20 h-20 rounded-full bg-card shadow ring-1 ring-border p-3"},[e("img",{src:w,class:"w-full h-full",alt:"Donner"})])],-1)),s[5]||(s[5]=e("h2",{class:"text-2xl font-semibold text-center mb-2"},"Create a Passcode",-1)),s[6]||(s[6]=e("p",{class:"text-muted-foreground text-center mb-6"}," A 4-digit passcode for quick access and added security. ",-1)),e("form",{onSubmit:k(b,["prevent"]),class:"space-y-4"},[e("div",null,[s[2]||(s[2]=e("label",{class:"block text-sm font-medium text-foreground mb-1"},"Passcode",-1)),p(e("input",{type:"password","onUpdate:modelValue":s[0]||(s[0]=u=>a.value=u),maxlength:"4",pattern:"[0-9]{4}",inputmode:"numeric",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-center text-2xl tracking-widest",placeholder:"••••",disabled:t.value},null,8,$),[[m,a.value]])]),e("div",null,[s[3]||(s[3]=e("label",{class:"block text-sm font-medium text-foreground mb-1"},"Confirm Passcode",-1)),p(e("input",{type:"password","onUpdate:modelValue":s[1]||(s[1]=u=>r.value=u),maxlength:"4",pattern:"[0-9]{4}",inputmode:"numeric",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-center text-2xl tracking-widest",placeholder:"••••",disabled:t.value},null,8,j),[[m,r.value]])]),o.value?(l(),c("p",q,P(o.value),1)):C("",!0),e("button",{type:"submit",disabled:t.value||!v.value,class:"w-full py-3 px-4 bg-primary hover:bg-primary/90 text-success-foreground font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[t.value?(l(),c("span",F,"Creating...")):(l(),c("span",M,"Create Passcode"))],8,z)],32),e("div",N,[e("button",{onClick:x,disabled:t.value,class:"text-muted-foreground hover:text-foreground text-sm underline"}," Skip for now ",8,U)])])])])])]),_:1}))}};export{J as default};
