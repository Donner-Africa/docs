import{l as C,R as G,V as z,U as f,p as x,r as v,a as l,f as d,b as t,t as n,n as m,d as u,w as y,e as a,h as _,P as w,v as A,x as T,s as k,F as U,g as M}from"./index-d5783bed.js";import{B as P}from"./BaseButton-dea80d57.js";import{M as Q}from"./Modal-1bb2a264.js";import{D as B}from"./AdvancedTable-4a37bf5a.js";import{C as D}from"./ConfigurationService-0bbd3fd3.js";import{f as R}from"./FormUtility-a2bc7d0b.js";const F={components:{BaseButton:P,Fire:G,Modal:Q,DonationsTable:B},data(){return{loading:{raiser:!0,transfers:!0},raiser:{},user:{},searchQuery:"",debouncedSearchQuery:"",searchTimeout:null,columns:[{label:"Fundraiser",key:"raiserTitle",sort:!1},{label:"Amount",key:"amount",formatter:s=>`₦${R(s)}`},{label:"Organizer",key:"raiserOrganizerName",sort:!1},{label:"Date",key:"date"}],sdgs:D.get("sdgs"),sdgColors:D.get("sdgColors"),selectedDonation:{},showDonationModal:!1,userGivingInformation:{dailyStreak:{}},userReceivingInformation:{numberOfRaisers:0,completed:0,inProgress:0,draft:0,completionPercentage:0}}},created(){const s=z();this.user=s.$state,this.loadUserGivingInformation(),this.loadUserReceivingInformation()},watch:{searchQuery(s){this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.debouncedSearchQuery=s},500)}},methods:{formatAmount:R,async loadUserGivingInformation(){try{const{data:s}=await f.fetchGivingInformation();this.userGivingInformation={...this.userGivingInformation,...s}}catch(s){x().toast({message:s.message||"Your giving information could not be loaded<br>Please reload the page",type:"error",duration:5e3})}},async loadUserReceivingInformation(){try{const{data:s}=await f.fetchReceivingInformation();this.userReceivingInformation={...this.userReceivingInformation,...s}}catch(s){x().toast({message:s.message||"Your receiving information could not be loaded<br>Please reload the page",type:"error",duration:5e3})}},async searchDonations(s){const{sort:o,direction:b,page:g=0,size:e=50,search:r}=s||{};try{const c={page:g,size:e,sort:o,direction:b,search:r};return await f.getUserDonations(c)}catch(c){x().toast({message:c.message||"Your donation information could not be loaded<br>Please reload the page",type:"error",duration:5e3})}},viewDonation(s){this.selectedDonation=s,this.showDonationModal=!0},reportDonation(s){const o=`Contribution Report - Reference: ${s}`,b=`Hello,

Please find the details of the donation below:

Reference: ${s}

Best regards,
${this.user.name}`,g=`mailto:report@donner.africa?subject=${encodeURIComponent(o)}&body=${encodeURIComponent(b)}`;window.location.href=g},downloadReceipt(s){f.downloadReceipt(s)}}},N={class:""},O={class:"container-fluid"},L={class:"row mb-3"},V={class:"col-sm-12 order-2 order-sm-0 text-start pt-3"},Y={class:"text-gradient text-foreground",style:{"font-size":"30px"}},j={class:"container-fluid py-4 px-md-2"},q={class:"row position-relative px-lg-4"},E={class:"col-lg-4 col-12 mt-0 no-scrollbar vh-90 order-1 order-lg-2 mb-4 px-4"},H={class:"position-sticky min-vh-25 no-scrollbar",style:{top:"100px"}},W={key:0,class:"card-body pt-4 text-center mt-4 mb-0 z-index-3"},X={class:"text-white mb-0 up"},J={class:"d-block"},K={key:1,class:"card-body pt-4 text-center mt-4 mb-0 z-index-3"},Z={class:"d-block"},$={key:2,class:"card-footer py-0 my-0 text-end mx-1 px-0"},tt={key:3,class:"position-absolute bottom-0 mt-8",style:{width:"50%",height:"0"}},ot={class:"position-relative w-[100%]"},et={class:"card overflow-hidden mt-4 shadow-none border border-light backdrop-blur-md mb-4"},st={class:"card-body p-3"},nt={class:"row"},it={class:"col-8"},rt={class:"d-flex"},at={class:"ms-3"},lt={class:"font-weight-bolder mb-0"},dt={class:"col-4 my-auto"},ct={class:"badge badge-dot d-block text-start pb-0"},mt={class:"text-muted text-xs font-weight-bold"},ut={class:"badge badge-dot d-block text-start"},bt={class:"text-muted text-xs font-weight-bold"},gt={class:"progress-wrapper col-12"},pt={class:"progress mt-3 mx-4"},ft=["aria-valuenow"],vt={class:"col-lg-8 rounded-3 border border-light order-lg-1 order-2 h-[100%]"},ht={class:"page-header min-vh-25 bg-muted/50 overflow-none",style:{border:"solid transparent 2px","border-width":"0 2px 2px 2px","border-radius":"0 0 0.5rem 0.5rem"}},xt={class:"container"},yt={class:"row"},_t={class:"col-11 text-start mx-auto mb-0 py-5"},wt={class:"row w-[100%]"},kt={class:"col-10"},Dt={class:"input-group"},Rt=["onClick"],It=["onClick"],St={class:"card bg-background/95 p-3 modal-fade-in shadow-xs rounded-3"},Ct={class:"card-body position-relative mx-1 rounded-3 row backdrop-blur-md border border-light mb-0 rounded-3"},Gt={class:"col-lg-12 py-5 text-foreground px-2 px-sm-5 text-start position-relative no-scrollbar",style:{overflow:"hidden","overflow-y":"scroll",height:"400px"}},zt={class:"mx-3 mx-md-0"},At={class:"row"},Tt={class:"col-3 position-relative mt-2",style:{scale:"0.2"}},Ut={class:"w-[100%] position-absolute ms-n8 pt-10"},Mt={class:"row mb-3 pt-3"},Pt={class:"col-12 mb-3"},Qt={class:"col-12 mb-3"},Bt={class:"col-12 mb-3"},Ft={class:"col-12 mb-3"},Nt={class:"col-12 mb-3"},Ot={class:"col-12 mb-3"},Lt={class:"badge badge text-success border border-0 border-success bg-success-light px-3"},Vt={class:"col-12 mb-4"},Yt={class:"col-6 mb-2"},jt={class:"card-footer mt-0 px-3 row"},qt={class:"backdrop-blur-md px-4 py-3 col-12 rounded-3"},Et={class:"row"},Ht={class:"col-12 text-end"},Wt=["href"];function Xt(s,o,b,g,e,r){const c=v("RouterLink"),p=v("Fire"),I=v("DonationsTable"),S=v("Modal");return l(),d("div",null,[t("section",N,[t("div",O,[t("div",L,[t("div",V,[t("h1",Y," Welcome "+n(e.user.firstName),1)])])]),t("div",j,[t("div",q,[t("div",E,[t("div",H,[t("div",{class:m(["card shadow-xs opacity-9 h-[100%] tilt position-relative",e.userGivingInformation.dailyStreak.streakDays?"bg-gray-900":"bg-success"]),"data-tilt":"",style:{"will-change":"transform",transform:"perspective(1000px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)"}},[e.userGivingInformation.dailyStreak.totalAmount?(l(),d("div",W,[o[6]||(o[6]=t("h2",{class:"text-white mb-0 mt-2 up"},"You've Given",-1)),t("h1",X,"₦"+n(r.formatAmount(e.userGivingInformation.dailyStreak.totalAmount||0)),1),t("div",J,[t("span",{class:m(["badge badge-lg bt-outline- text-white px-5 mb-2 up",e.userGivingInformation.dailyStreak.totalAmount?"bg-success":"bg-gray-800"]),style:{"font-size":"19px !important"}},"This Streak",2)]),t("div",{class:m(["btn btn-white text-lg px-5 up",e.userGivingInformation.dailyStreak.totalAmount>0?"mb-0":"mb-4"]),style:{"font-size":"19px !important"}},"Lifetime – ₦"+n(r.formatAmount(e.userGivingInformation.sumOfDonations||0)),3)])):(l(),d("div",K,[o[8]||(o[8]=t("h2",{class:"text-white mb-0 mt-2 up"},"Start Your Giving Streak",-1)),o[9]||(o[9]=t("h1",{class:"text-success mb-0 up"},".",-1)),t("div",Z,[u(c,{to:"/raisers",class:m(["badge badge-lg btn-outline-success text-white px-5 mb-2 up",e.userGivingInformation.dailyStreak.totalAmount?"bg-success":"bg-gray-800"]),style:{"font-size":"19px !important"}},{default:y(()=>[...o[7]||(o[7]=[a(" Give ",-1)])]),_:1},8,["class"])]),t("div",{class:m(["btn btn-white text-lg px-5 up",e.userGivingInformation.dailyStreak.totalAmount>0?"mb-0":"mb-4"]),style:{"font-size":"19px !important"}}," Lifetime – ₦"+n(r.formatAmount(e.userGivingInformation.sumOfDonations||0)),3)])),e.userGivingInformation.dailyStreak.totalAmount>0?(l(),d("div",$,[...o[10]||(o[10]=[t("p",{class:"text-white text-xs font-weight-bolder text-uppercase cursor-pointer btn btn-link my-0 pt-0 me-0"},null,-1)])])):_("",!0),e.userGivingInformation.dailyStreak.totalAmount>1e4?(l(),d("div",tt,[t("span",ot,[u(p)])])):_("",!0)],2),t("div",et,[t("div",st,[t("div",nt,[t("div",it,[t("div",rt,[t("div",at,[o[11]||(o[11]=t("p",{class:"text-sm mb-2 text-capitalize font-weight-bold"},"Raising Success ",-1)),t("h5",lt,n(e.userReceivingInformation.numberOfRaisers||0)+" Fundraiser"+n(e.userReceivingInformation.numberOfRaisers==1?"":"s"),1)])])]),t("div",dt,[t("span",ct,[o[12]||(o[12]=t("i",{class:"bg-gradient-success"},null,-1)),t("span",mt,n(e.userReceivingInformation.inProgress||0)+" Active",1)]),t("span",ut,[o[13]||(o[13]=t("i",{class:"bg-gradient-secondary"},null,-1)),t("span",bt,n(e.userReceivingInformation.draft||0)+" Draft"+n(e.userReceivingInformation.draft==1?"":"s"),1)])]),t("div",gt,[t("div",pt,[t("div",{class:"progress-bar bg-gradient-primary",role:"progressbar","aria-valuenow":e.userReceivingInformation.draft,"aria-valuemin":"0","aria-valuemax":"100",style:w({width:`${e.userReceivingInformation.completionPercentage||0}%`})},null,12,ft)])])])])])])]),t("div",vt,[t("div",ht,[o[16]||(o[16]=t("div",{class:"mask blur-sm",style:{"background-image":"url('/img/shapes/waves-green.png')",opacity:"0.05 !important"}},null,-1)),o[17]||(o[17]=t("div",{class:"mask bg-muted/30 opacity-3"},null,-1)),t("div",xt,[t("div",yt,[t("div",_t,[o[15]||(o[15]=t("h3",{class:"text-foreground text-gradient mb-3"}," My Donations ",-1)),t("form",wt,[t("div",kt,[t("div",Dt,[o[14]||(o[14]=t("span",{class:"input-group-text"},[t("i",{class:"text-foreground px-2 fa fa-search"})],-1)),A(t("input",{required:"",type:"text",class:"form-control text-secondary","onUpdate:modelValue":o[0]||(o[0]=i=>e.searchQuery=i),placeholder:"Find by fundraiser's title"},null,512),[[T,e.searchQuery]])])])])])])])]),u(I,{hasActions:!1,loadAsync:!0,selectedRow:e.selectedDonation,"onUpdate:selectedRow":[o[1]||(o[1]=i=>e.selectedDonation=i),r.viewDonation],apiUrl:"/me/donations",fetchData:r.searchDonations,filterQuery:e.debouncedSearchQuery,columns:e.columns},{actions:y(({row:i})=>[t("button",{class:"btn btn-outline-success border-light btn-sm rounded-2 text-sm px-2 me-3",onClick:k(h=>r.viewDonation(i),["stop"])}," View ",8,Rt),t("button",{class:"btn btn-white text-success btn-sm px-1 rounded-1 border border-light border-success text-center",title:"Print Receipt",onClick:k(h=>r.downloadReceipt(i.reference),["stop"])},[...o[18]||(o[18]=[t("i",{class:"fa fa-receipt",style:{"font-size":"16px"}},null,-1)])],8,It)]),_:1},8,["selectedRow","fetchData","filterQuery","columns","onUpdate:selectedRow"])])])])]),u(S,{show:e.showDonationModal,"onUpdate:show":o[5]||(o[5]=i=>e.showDonationModal=i),"body-classes":"p-0","modal-classes":"modal-lg"},{default:y(()=>[t("div",St,[t("button",{onClick:o[2]||(o[2]=i=>e.showDonationModal=!1),class:"position-absolute end-0 me-4 mt-1 btn btn-sm backdrop-blur-md bg-secondary rounded-3 rounded-3 px-2 py-1",style:{"z-index":"1000000"}},[...o[19]||(o[19]=[t("i",{class:"fa fa-times text-white",style:{"font-size":"15px"}},null,-1)])]),t("div",Ct,[t("div",Gt,[t("div",zt,[t("div",At,[o[20]||(o[20]=t("div",{class:"col-9"},[t("h4",{class:"text-start text-foreground pb-2"},"Transaction Summary")],-1)),t("div",Tt,[t("div",Ut,[u(p)])])]),o[32]||(o[32]=t("hr",{class:"horizontal dark"},null,-1)),t("div",Mt,[t("div",Pt,[o[21]||(o[21]=t("strong",null," To: ",-1)),a(" "+n(e.selectedDonation.raiserTitle),1)]),t("div",Qt,[o[22]||(o[22]=t("strong",null,"Giver:",-1)),a(" "+n(e.selectedDonation.name),1)]),t("div",Bt,[o[23]||(o[23]=t("strong",null,"Beneficiary:",-1)),a(" "+n(e.selectedDonation.raiserOrganizerName),1)]),t("div",Ft,[o[24]||(o[24]=t("strong",null,"Date:",-1)),a(" "+n(e.selectedDonation.formattedDate),1)]),t("div",Nt,[o[25]||(o[25]=t("strong",null,"Amount:",-1)),a(" ₦"+n(r.formatAmount(e.selectedDonation.amount)),1)]),t("div",Ot,[o[27]||(o[27]=t("strong",{class:"me-2"},"Category:",-1)),t("span",Lt,[a(n(e.selectedDonation.raiserCategory)+" ",1),o[26]||(o[26]=t("i",{class:"fa fa-arrow-right text-foreground mx-2"},null,-1)),a(" "+n(e.selectedDonation.raiserSubCategory),1)])]),t("div",Vt,[o[28]||(o[28]=t("strong",{class:"me-2"},[t("u",null,"Supported Goals")],-1)),o[29]||(o[29]=t("br",null,null,-1)),(l(!0),d(U,null,M(e.selectedDonation.sdgs,(i,h)=>(l(),d("span",{key:h,class:"badge me-1 mb-1",style:w({backgroundColor:"#"+e.sdgColors[i-1]})},n(e.sdgs[i-1]),5))),128))]),t("div",Yt,[t("button",{class:"btn btn-link text-foreground",onClick:o[3]||(o[3]=i=>r.reportDonation(e.selectedDonation.reference))},[...o[30]||(o[30]=[t("i",{class:"fa fa-flag me-2"},null,-1),a(" Report ",-1)])])]),o[31]||(o[31]=t("div",{class:"mb-8"},null,-1))]),o[33]||(o[33]=t("hr",null,null,-1))])])]),t("div",jt,[t("div",qt,[t("div",Et,[t("div",Ht,[t("a",{href:e.selectedDonation.raiserURL,target:"_blank",class:"btn btn-success mb-0 mx-3"}," Give ",8,Wt),t("button",{onClick:o[4]||(o[4]=i=>r.downloadReceipt(e.selectedDonation.reference)),class:"btn btn-outline-success backdrop-blur-md mb-0"}," Print Receipt ")])])])])])]),_:1},8,["show"])])}const eo=C(F,[["render",Xt],["__scopeId","data-v-1320c797"]]);export{eo as default};
