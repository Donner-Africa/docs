import{B as k}from"./BaseButton-e295f265.js";import{l as q,A as m,p,r as g,a as d,f as c,b as e,q as R,s as h,n as f,v,x,F as I,g as V,d as y,w,e as u,t as T}from"./index-f692fab2.js";const B={components:{BaseButton:k},data(){return{email:"",token:[],loading:!1,requestingReset:!0,resendCount:0,resendWaitTime:0}},computed:{formDisabled(){return this.loading||void 0}},methods:{async requestPasswordReset(){if(this.email){this.loading=!0;try{await m.requestPasswordReset(this.email),this.requestingReset=!1}catch{p().toast({message:"If an account with that email exists, a verification link has been sent to the email linked to your account",duration:5e3,type:"info"})}this.loading=!1}},paste(s,t){const o=(s.clipboardData||window.clipboardData).getData("text").trim();this.token=["",...o.split("")],o.length===6&&this.completeVerification()},focusNext(s,t){const o=`${s.target.value}`.trim();if(t==6&&o)return this.completeVerification();if(o.length===1&&t<6){const l="otpInput"+(t+1);this.$refs[l][0].focus()}o.length===0&&t>1&&this.$refs["otpInput"+(t-1)][0].focus()},countDown(){this.resendWaitTime=60+this.resendCount;const s=setInterval(()=>--this.resendWaitTime,998);setTimeout(()=>{clearInterval(s),this.resendWaitTime=0},this.resendWaitTime*1e3)},async reInitiateVerification(){const s=p();try{if(this.resendCount>90)return;const{data:t,message:o}=await m.requestPasswordReset(this.email);this.countDown(),this.resendCount+=30,s.toast({message:o||"A new verification code has been sent to you.",type:"success",duration:5e3})}catch(t){s.toast({message:t.message,type:"error",duration:5e3})}},async completeVerification(){this.loading=!0;try{const s=this.token.reduce((o,l)=>`${o}${l}`),t=await m.validatePasswordReset(s);this.$router.push("/account/password-reset/complete")}catch(s){p().toast({message:s.message,duration:5e3,type:"error"})}this.loading=!1}}},D={class:"page-header min-vh-100 align-items-start bg-success-light"},S={class:"container px-sm-auto px-0"},C={class:"row"},N={class:"col-lg-6 col-md-7 mx-sm-auto mx-0 my-0 my-sm-5 px-0 px-sm-auto py-sm-7"},W={class:"card rounded-3 min-vh-100 min-vh-sm-80 bg-white",style:{}},P={class:"card-body px-lg-5 py-lg-5 text-start"},A={class:"px-md-4 ps-2 pe-4 row"},L={class:"input-group"},U=["disabled"],z={class:"row"},E={class:"form-group"},F=["onUpdate:modelValue","disabled","onInput"],M={class:"form-group mt-3"},H={key:0,class:"w-[100%] mb-4 text-bold text-dark"},K={key:1,class:"w-[100%] mb-4 text-gradient text-dark"},Y={class:"form-group mt-3"},j={class:"text-lg text-gradient text-dark"};function G(s,t,o,l,i,a){const b=g("BaseButton"),_=g("RouterLink");return d(),c("div",null,[e("section",null,[e("div",D,[t[13]||(t[13]=e("div",{class:"mask opacity-1",style:{"background-image":"url('/img/shapes/waves-green.png')",filter:"blur(9px)"}},null,-1)),e("div",S,[e("div",C,[e("div",N,[e("div",W,[e("div",P,[t[10]||(t[10]=e("div",{class:"success mb-6 mb-md-4"},[e("a",{href:"/",class:"icon icon-shape icon-xl rounded-circle bg-white shadow text-center p-3 mx-auto"},[e("img",{src:R,class:"w-[90%] h-[90%] mt-1"})])],-1)),t[11]||(t[11]=e("h2",null,"Reset your password",-1)),t[12]||(t[12]=e("p",{class:"mb-4"},"Secure your account with a new password.",-1)),e("form",{class:"",onSubmit:t[3]||(t[3]=h(n=>i.requestingReset?a.requestPasswordReset():a.completeVerification(),["prevent"]))},[e("div",A,[e("div",{class:f(["form-group mt-3 col-12 form-section",{active:i.requestingReset}])},[t[5]||(t[5]=e("label",{class:"text-gradient text-dark text-sm"}," Email Address ",-1)),e("div",L,[t[4]||(t[4]=e("span",{class:"input-group-text px-3"},[e("i",{class:"fas fa-leaf","aria-hidden":"true"})],-1)),v(e("input",{class:"form-control form-control-lg text-lg",disabled:a.formDisabled,"onUpdate:modelValue":t[0]||(t[0]=n=>i.email=n),required:"",type:"email",placeholder:"email@domain.com"},null,8,U),[[x,i.email]])])],2),e("div",{class:f(["form-group mt-3 form-section",{active:!i.requestingReset}])},[e("div",z,[(d(),c(I,null,V(6,n=>e("div",{class:"col-2",key:n},[e("div",E,[v(e("input",{type:"text",class:"form-control form-control-lg text-center px-0 border",maxlength:"1","onUpdate:modelValue":r=>i.token[n]=r,autocomplete:"off",disabled:a.formDisabled,autocapitalize:"none",ref_for:!0,ref:"otpInput"+n,onPaste:t[1]||(t[1]=h((...r)=>a.paste&&a.paste(...r),["prevent"])),onInput:r=>a.focusNext(r,n)},null,40,F),[[x,i.token[n]]])])])),64))])],2),e("div",M,[y(b,{class:"btn btn-success float-end",loading:i.loading,nativeType:"submit"},{default:w(()=>[...t[6]||(t[6]=[u(" Continue ",-1)])]),_:1},8,["loading"]),e("div",{class:f(["form-section",{active:!i.requestingReset}])},[i.resendWaitTime==0?(d(),c("span",H,[t[7]||(t[7]=u(" If you do not receive a code in 5 minutes, you can ",-1)),e("span",{onClick:t[2]||(t[2]=(...n)=>a.reInitiateVerification&&a.reInitiateVerification(...n)),style:{cursor:"pointer"},class:"text-success"}," request another code ")])):(d(),c("span",K," You can request another verification code in "+T(i.resendWaitTime)+"s ",1))],2)]),e("div",Y,[e("span",j,[t[9]||(t[9]=u(" Have an account? ",-1)),y(_,{to:"/account/login",class:"text-primary text-bold text-gradient"},{default:w(()=>[...t[8]||(t[8]=[u(" Login ",-1)])]),_:1})])])])],32)])])])])])])])])}const Q=q(B,[["render",G]]);export{Q as default};
