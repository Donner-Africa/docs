import{B as q}from"./BaseButton-c6c5ab63.js";import{_ as R}from"./PublicLayout-5ccc5a06.js";import{l as I,A as u,p as m,r as p,a as c,c as V,w as f,b as e,z as B,q as v,n as g,s as x,v as y,f as h,F as T,g as D,e as b,d,t as S}from"./index-7ab8b32e.js";import"./logo-f32e4fd3.js";import"./NavigationStore-5ae23ca1.js";import"./StarryBackground-a80d183f.js";const C={components:{BaseButton:q,PublicLayout:R},data(){return{email:"",token:[],loading:!1,requestingReset:!0,resendCount:0,resendWaitTime:0}},computed:{formDisabled(){return this.loading||void 0}},methods:{async requestPasswordReset(){if(this.email){this.loading=!0;try{await u.requestPasswordReset(this.email),this.requestingReset=!1}catch{m().toast({message:"If an account with that email exists, a verification link has been sent to the email linked to your account",duration:5e3,type:"info"})}this.loading=!1}},paste(s,t){const o=(s.clipboardData||window.clipboardData).getData("text").trim();this.token=["",...o.split("")],o.length===6&&this.completeVerification()},focusNext(s,t){const o=`${s.target.value}`.trim();if(t==6&&o)return this.completeVerification();if(o.length===1&&t<6){const l="otpInput"+(t+1);this.$refs[l][0].focus()}o.length===0&&t>1&&this.$refs["otpInput"+(t-1)][0].focus()},countDown(){this.resendWaitTime=60+this.resendCount;const s=setInterval(()=>--this.resendWaitTime,998);setTimeout(()=>{clearInterval(s),this.resendWaitTime=0},this.resendWaitTime*1e3)},async reInitiateVerification(){const s=m();try{if(this.resendCount>90)return;const{data:t,message:o}=await u.requestPasswordReset(this.email);this.countDown(),this.resendCount+=30,s.toast({message:o||"A new verification code has been sent to you.",type:"success",duration:5e3})}catch(t){s.toast({message:t.message,type:"error",duration:5e3})}},async completeVerification(){this.loading=!0;try{const s=this.token.reduce((o,l)=>`${o}${l}`),t=await u.validatePasswordReset(s);this.$router.push("/account/password-reset/complete")}catch(s){m().toast({message:s.message,duration:5e3,type:"error"})}this.loading=!1}}},P={class:"page-header min-vh-100 align-items-start bg-background"},L={class:"container px-sm-auto px-0"},N={class:"row"},W={class:"col-lg-6 col-md-7 mx-sm-auto mx-0 my-0 my-sm-5 px-0 px-sm-auto py-sm-7"},A={class:"card rounded-3 min-vh-100 min-vh-sm-80 bg-transparent"},z={class:"card-body px-lg-5 py-lg-5 text-start"},U={class:"px-md-4 ps-2 pe-4 row"},E={class:"input-group"},F=["disabled"],M={class:"row"},H={class:"form-group"},K=["onUpdate:modelValue","disabled","onInput"],Y={class:"form-group mt-3"},j={key:0,class:"w-[100%] mb-4 text-bold text-foreground"},G={key:1,class:"w-[100%] mb-4 text-foreground"},J={class:"form-group mt-3"},O={class:"text-lg text-foreground"};function Q(s,t,o,l,i,r){const _=p("BaseButton"),w=p("RouterLink"),k=p("PublicLayout");return c(),V(k,null,{default:f(()=>[e("section",null,[e("div",P,[e("div",L,[e("div",N,[e("div",W,[e("div",A,[e("div",z,[t[10]||(t[10]=e("div",{class:"success mb-6 mb-md-4"},[e("a",{href:"/",class:"icon icon-shape icon-xl rounded-circle bg-background shadow text-center p-3 mx-auto"},[e("img",{src:B,class:"w-[90%] h-[90%] mt-1"})])],-1)),t[11]||(t[11]=e("h2",{class:"text-foreground"},"Reset your password",-1)),t[12]||(t[12]=e("p",{class:"mb-4 text-foreground opacity-8"},"Secure your account with a new password. ",-1)),e("form",{class:"",onSubmit:t[3]||(t[3]=v(n=>i.requestingReset?r.requestPasswordReset():r.completeVerification(),["prevent"]))},[e("div",U,[e("div",{class:g(["form-group mt-3 col-12 form-section",{active:i.requestingReset}])},[t[5]||(t[5]=e("label",{class:"text-foreground text-sm"}," Email Address ",-1)),e("div",E,[t[4]||(t[4]=e("span",{class:"input-group-text px-3"},[e("i",{class:"fas fa-leaf","aria-hidden":"true"})],-1)),x(e("input",{class:"form-control form-control-lg text-lg",disabled:r.formDisabled,"onUpdate:modelValue":t[0]||(t[0]=n=>i.email=n),required:"",type:"email",placeholder:"email@domain.com"},null,8,F),[[y,i.email]])])],2),e("div",{class:g(["form-group mt-3 form-section",{active:!i.requestingReset}])},[e("div",M,[(c(),h(T,null,D(6,n=>e("div",{class:"col-2",key:n},[e("div",H,[x(e("input",{type:"text",class:"form-control form-control-lg text-center px-0 border",maxlength:"1","onUpdate:modelValue":a=>i.token[n]=a,autocomplete:"off",disabled:r.formDisabled,autocapitalize:"none",ref_for:!0,ref:"otpInput"+n,onPaste:t[1]||(t[1]=v((...a)=>r.paste&&r.paste(...a),["prevent"])),onInput:a=>r.focusNext(a,n)},null,40,K),[[y,i.token[n]]])])])),64))])],2),e("div",Y,[b(_,{class:"btn btn-primary float-end",loading:i.loading,nativeType:"submit"},{default:f(()=>[...t[6]||(t[6]=[d(" Continue ",-1)])]),_:1},8,["loading"]),e("div",{class:g(["form-section",{active:!i.requestingReset}])},[i.resendWaitTime==0?(c(),h("span",j,[t[7]||(t[7]=d(" If you do not receive a code in 5 minutes, you can ",-1)),e("span",{onClick:t[2]||(t[2]=(...n)=>r.reInitiateVerification&&r.reInitiateVerification(...n)),style:{cursor:"pointer"},class:"text-success"}," request another code ")])):(c(),h("span",G," You can request another verification code in "+S(i.resendWaitTime)+"s ",1))],2)]),e("div",J,[e("span",O,[t[9]||(t[9]=d(" Have an account? ",-1)),b(w,{to:"/account/login",class:"text-success text-bold"},{default:f(()=>[...t[8]||(t[8]=[d(" Login ",-1)])]),_:1})])])])],32)])])])])])])])]),_:1})}const ot=I(C,[["render",Q]]);export{ot as default};
